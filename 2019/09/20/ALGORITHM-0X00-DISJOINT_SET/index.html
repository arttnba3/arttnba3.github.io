

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="arttnba3">
  <meta name="keywords" content="">
  
    <meta name="description" content="集你太美，babe！">
<meta property="og:type" content="article">
<meta property="og:title" content="【ALGORITHM.0x00】并查集算法浅析">
<meta property="og:url" content="https://arttnba3.github.io/2019/09/20/ALGORITHM-0X00-DISJOINT_SET/index.html">
<meta property="og:site_name" content="arttnba3&#39;s blog">
<meta property="og:description" content="集你太美，babe！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2025/03/07/Z6qpibvaGfPuFmX.png">
<meta property="article:published_time" content="2019-09-20T13:49:22.000Z">
<meta property="article:modified_time" content="2025-03-07T21:15:05.136Z">
<meta property="article:author" content="arttnba3">
<meta property="article:tag" content="C&amp;C++">
<meta property="article:tag" content="Algorithm">
<meta property="article:tag" content="Disjoint Set">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2025/03/07/Z6qpibvaGfPuFmX.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>【ALGORITHM.0x00】并查集算法浅析 - arttnba3&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"arttnba3.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="arttnba3's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>arttnba3&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/arttnba3">
                <i class="iconfont icon-github-fill"></i>
                GitHub
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                rss
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://s2.loli.net/2025/03/07/Z6qpibvaGfPuFmX.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="【ALGORITHM.0x00】并查集算法浅析"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-09-20 23:49" pubdate>
          2019年9月20日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          13k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          106 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">【ALGORITHM.0x00】并查集算法浅析</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：2025年3月8日 早上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>集你太美，babe！</p>
<span id="more"></span>

<blockquote>
<p>注：比古老的 CSDN 博客更古老的新浪博客内容拾遗：）</p>
</blockquote>
<blockquote>
<p>注2：本文经过翻新已正式上线西安电子科技大学 2020 年下学期选修课《ACM程序设计》的课前演讲！欢迎大家 11 月 2 号晚上前来 B-106 听什么厉害的 OI 奖都没拿过的作者吹水（什么鬼）！</p>
</blockquote>
<h1 id="0x00-绪论"><a href="#0x00-绪论" class="headerlink" title="0x00. 绪论"></a>0x00. 绪论</h1><p>在正式介绍并查集之前，我们先来简单看看这样的一个问题：</p>
<blockquote>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><h6 id="若某个家族人员过于庞大，要判断两个是否是亲戚，确实还很不容易，给出某个亲戚关系图，求任意给出的两个人是否具有亲戚关系。-规定：x和y是亲戚，y和z是亲戚，那么x和z也是亲戚。如果x-y是亲戚，那么x的亲戚都是y的亲戚，y的亲戚也都是x的亲戚。"><a href="#若某个家族人员过于庞大，要判断两个是否是亲戚，确实还很不容易，给出某个亲戚关系图，求任意给出的两个人是否具有亲戚关系。-规定：x和y是亲戚，y和z是亲戚，那么x和z也是亲戚。如果x-y是亲戚，那么x的亲戚都是y的亲戚，y的亲戚也都是x的亲戚。" class="headerlink" title="若某个家族人员过于庞大，要判断两个是否是亲戚，确实还很不容易，给出某个亲戚关系图，求任意给出的两个人是否具有亲戚关系。 规定：x和y是亲戚，y和z是亲戚，那么x和z也是亲戚。如果x,y是亲戚，那么x的亲戚都是y的亲戚，y的亲戚也都是x的亲戚。"></a>若某个家族人员过于庞大，要判断两个是否是亲戚，确实还很不容易，给出某个亲戚关系图，求任意给出的两个人是否具有亲戚关系。 规定：x和y是亲戚，y和z是亲戚，那么x和z也是亲戚。如果x,y是亲戚，那么x的亲戚都是y的亲戚，y的亲戚也都是x的亲戚。</h6><h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><h6 id="第一行：三个整数n-m-p，（n-5000-m-5000-p-5000），分别表示有n个人，m个亲戚关系，询问p对亲戚关系。-以下m行：每行两个数Mi，Mj，1-Mi，Mj-N，表示Mi和Mj具有亲戚关系。-接下来p行：每行两个数Pi，Pj，询问Pi和Pj是否具有亲戚关系。"><a href="#第一行：三个整数n-m-p，（n-5000-m-5000-p-5000），分别表示有n个人，m个亲戚关系，询问p对亲戚关系。-以下m行：每行两个数Mi，Mj，1-Mi，Mj-N，表示Mi和Mj具有亲戚关系。-接下来p行：每行两个数Pi，Pj，询问Pi和Pj是否具有亲戚关系。" class="headerlink" title="第一行：三个整数n,m,p，（n&lt; &#x3D;5000,m&lt; &#x3D;5000,p&lt; &#x3D;5000），分别表示有n个人，m个亲戚关系，询问p对亲戚关系。 以下m行：每行两个数Mi，Mj，1&lt; &#x3D;Mi，Mj&lt; &#x3D;N，表示Mi和Mj具有亲戚关系。 接下来p行：每行两个数Pi，Pj，询问Pi和Pj是否具有亲戚关系。"></a>第一行：三个整数n,m,p，（n&lt; &#x3D;5000,m&lt; &#x3D;5000,p&lt; &#x3D;5000），分别表示有n个人，m个亲戚关系，询问p对亲戚关系。 以下m行：每行两个数Mi，Mj，1&lt; &#x3D;Mi，Mj&lt; &#x3D;N，表示Mi和Mj具有亲戚关系。 接下来p行：每行两个数Pi，Pj，询问Pi和Pj是否具有亲戚关系。</h6><h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><h6 id="P行，每行一个’Yes’或’No’。表示第i个询问的答案为“具有”或“不具有”亲戚关系。"><a href="#P行，每行一个’Yes’或’No’。表示第i个询问的答案为“具有”或“不具有”亲戚关系。" class="headerlink" title="P行，每行一个’Yes’或’No’。表示第i个询问的答案为“具有”或“不具有”亲戚关系。"></a>P行，每行一个’Yes’或’No’。表示第i个询问的答案为“具有”或“不具有”亲戚关系。</h6><p>来源：【洛谷1551《亲戚》】<a target="_blank" rel="noopener" href="https://www.luogu.org/problem/P1551">https://www.luogu.org/problem/P1551</a></p>
</blockquote>
<p>简化一下：给定n组亲戚关系，询问i对亲戚ai与bi间是否存在亲戚关系，如何解决这个问题呢？</p>
<p>你可能很快就能给出回答：当然是设定数个集合将 <strong>从属不同关系的亲戚</strong> 划分到 <strong>不同的集合</strong> 当中啦！</p>
<p>那么，具体实现呢？</p>
<p>若是每一次读取亲戚关系都要遍历所有集合查找一次 <em>“该亲戚是否属于第一个集合、第二个集合……”</em> ，很显然，反复的查找使得我们的时间复杂度大幅度提高，最高甚至可能会有 <strong>O(M^2^Q)</strong></p>
<p>而无论是在ACM，NOI，还是其他的算法竞赛当中，若是在那台小破机子上跑这样的无脑且低效率的算法，无疑是要TLE的……</p>
<p>于是便有了 <strong>时间复杂度仅为O(N+M+Q)的</strong> 并查集算法的出现</p>
<p>（由于作者水平有限，因而只给出入门级别的并查集介绍与实现思路）</p>
<h1 id="0x01-简介：什么是并查集？"><a href="#0x01-简介：什么是并查集？" class="headerlink" title="0x01. 简介：什么是并查集？"></a>0x01. 简介：什么是并查集？</h1><p>并查集算法是一种用于快速查询不同元素所属集合的算法，常见于各类oi当中，为了优化查找时间而开发出的一种特殊的算法</p>
<p>某种程度而言，<strong>并查集是一种较为特殊的树型的数据结构（森林）</strong>，其核心思路是 <strong>将多个相同属性的节点连接到同一棵树中（路径压缩）</strong> ，从而能用于快速处理不相交的集合的合并与查询的问题</p>
<p>时间复杂度为线性的<strong>O(N+M+Q)</strong></p>
<h2 id="基本原理：优化路径压缩"><a href="#基本原理：优化路径压缩" class="headerlink" title="基本原理：优化路径压缩"></a>基本原理：优化路径压缩</h2><p>在初始时， <strong>每个元素都单独作为一个独立的集合（一棵只有根节点的树）</strong> ，并 <strong>在查询过程中进行路径压缩</strong> ，将所有有关系的元素同归于一个集合之下：</p>
<ul>
<li>初始化：将每个节点初始化为一个独立的集合—— <strong>节点指向自身</strong></li>
<li>建立关系：对于存在关系的两个节点，将其归为同一集合—— <strong>被合并节点指向另一节点</strong></li>
<li>查询： <strong>节点的归属集合为其所在树的根节点</strong> ，在查询过程中将路径上经过的节点 <strong>都更新为指向根节点</strong> ——完成路径压缩</li>
</ul>
<p><img src="https://s2.loli.net/2025/03/07/Z6qpibvaGfPuFmX.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="例题：洛谷-P1551"><a href="#例题：洛谷-P1551" class="headerlink" title="例题：洛谷 P1551"></a>例题：洛谷 P1551</h2><p>题目我们已经在前面摘抄了，现在我们来看解法</p>
<h3 id="（1）初始化元素集合"><a href="#（1）初始化元素集合" class="headerlink" title="（1）初始化元素集合"></a>（1）初始化元素集合</h3><p>首先建立一个全局数组，并将其中的值全部初始化为自身（即，为每个可能存在的人单独开一个集合）</p>
<p>数组的每一个元素表示一个可能存在的亲戚，其值即为所属的并查集（树）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> u[<span class="hljs-number">5001</span>];<br><span class="hljs-comment">// ......</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5001</span>;i++)<br>    u[i]=i;<br></code></pre></td></tr></table></figure>

<h3 id="（2）建立关系：集合合并"><a href="#（2）建立关系：集合合并" class="headerlink" title="（2）建立关系：集合合并"></a>（2）建立关系：集合合并</h3><p>当我们读入一组亲戚关系之后，我们利用并查集的特性，搜寻这一对元素分别所属的集合，并进行对比，若不一致，则将两集合进行合并：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>&#123;<br>    cin&gt;&gt;a&gt;&gt;b;<br>    a=<span class="hljs-built_in">find_x</span>(a);<br>    b=<span class="hljs-built_in">find_x</span>(b);<br>    <span class="hljs-keyword">if</span>(a!=b) &#123;<br>        u[a]=b;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="（3）搜索函数：找寻元素最终所属的集合"><a href="#（3）搜索函数：找寻元素最终所属的集合" class="headerlink" title="（3）搜索函数：找寻元素最终所属的集合"></a>（3）搜索函数：找寻元素最终所属的集合</h3><p>这里运用了简单的递归来实现这一功能：</p>
<p>若是所查找元素与自身的值不相同，说明该元素属于其值所在元素，于是我们再查找其值所在元素，一层一层查找下去便能找到最终其所属的“根集合”</p>
<p>若是所查找元素与自身的值相等，那么他就是这一个并查集的“根元素”，于是我们便将最终归属的“根集合”返回至上层函数</p>
<p>话不多说，上具体代码实现：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_x</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(x==u[x])<br>        <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">find_x</span>(u[x]);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="（4）对比元素所属集合是否相同"><a href="#（4）对比元素所属集合是否相同" class="headerlink" title="（4）对比元素所属集合是否相同"></a>（4）对比元素所属集合是否相同</h3><p>这里没什么需要解析的，利用上文所给出的搜索函数查找所需比对关系的元素所属的集合，进行对比，即可知道其是否同属于一个集合<br>代码实现：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cin&gt;&gt;a&gt;&gt;b;<br>a=<span class="hljs-built_in">find_x</span>(a);<br>b=<span class="hljs-built_in">find_x</span>(b);<br><span class="hljs-keyword">if</span>(a==b)<br>    cout&lt;&lt;<span class="hljs-string">&quot;Yes&quot;</span>&lt;&lt;endl;<br><span class="hljs-keyword">else</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;No&quot;</span>&lt;&lt;endl;<br></code></pre></td></tr></table></figure>

<h3 id="（5）完整代码实现"><a href="#（5）完整代码实现" class="headerlink" title="（5）完整代码实现"></a>（5）完整代码实现</h3><p>（洛谷1551题解）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_x</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>;<br><br><span class="hljs-type">int</span> u[<span class="hljs-number">5001</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n,m,p,i,a,b;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5001</span>;i++)<br>        u[i]=i;<br>    cin&gt;&gt;n&gt;&gt;m&gt;&gt;p;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;m;i++)<br>    &#123;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        a=<span class="hljs-built_in">find_x</span>(a);<br>        b=<span class="hljs-built_in">find_x</span>(b);<br>        <span class="hljs-keyword">if</span>(a!=b)<br>            u[a]=b;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;p;i++)<br>    &#123;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        a=<span class="hljs-built_in">find_x</span>(a);<br>        b=<span class="hljs-built_in">find_x</span>(b);<br>        <span class="hljs-keyword">if</span>(a==b)<br>            cout&lt;&lt;<span class="hljs-string">&quot;Yes&quot;</span>&lt;&lt;endl;<br>        <span class="hljs-keyword">else</span><br>            cout&lt;&lt;<span class="hljs-string">&quot;No&quot;</span>&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_x</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(x==u[x])<br>        <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">find_x</span>(u[x]);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="0x02-进阶：二维空间上的并查集应用"><a href="#0x02-进阶：二维空间上的并查集应用" class="headerlink" title="0x02. 进阶：二维空间上的并查集应用"></a>0x02. 进阶：二维空间上的并查集应用</h1><p>除了可以应用于“亲戚关系”这样的图结构当中，并查集还能用于图上的结构相交的应用，下面我们来看一道 OI 实战中出现过的题目（虽然说作者当年没能很好地做出来…）</p>
<h2 id="例题：NOIP-2017-提高组-Day2-T1-奶酪（普及-提高-）"><a href="#例题：NOIP-2017-提高组-Day2-T1-奶酪（普及-提高-）" class="headerlink" title="例题：NOIP 2017 提高组 Day2 T1 - 奶酪（普及&#x2F;提高-）"></a>例题：NOIP 2017 提高组 Day2 T1 - 奶酪（普及&#x2F;提高-）</h2><blockquote>
<h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>（实在是没法把原格式很好地复制进来…）</p>
<p><img src="https://s2.loli.net/2025/03/07/yo4Dmu2H5ejx36k.png" srcset="/img/loading.gif" lazyload></p>
<p>来源：【洛谷P3958 [NOIP 2017 提高组] 奶酪】<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3958">https://www.luogu.com.cn/problem/P3958</a></p>
</blockquote>
<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>咋一看我们需要判断多个洞之间非常复杂的连接问题，但实际上我们只需要判断从下面的洞是否能够走到上面的洞（说了好像没说……）</p>
<p>但既然当两个洞相交时，这两个洞是连通的，我们不难想到的是这同样可以使用并查集的集合约束技术来解决这个问题——也就是说 <strong>对于相交的两个洞，我们可以认为他们属于同一个集合</strong> </p>
<p>因此，我们最后需要求解的只是 <strong>是否存在与上层的洞属于同一集合的下层的洞</strong> </p>
<h3 id="（1）初始化元素集合-1"><a href="#（1）初始化元素集合-1" class="headerlink" title="（1）初始化元素集合"></a>（1）初始化元素集合</h3><p>我们首先要为每个洞独立定义一个集合，并定义顶部洞集合与底部洞集合，在读取过程中同步初始化这三个数组：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> u[<span class="hljs-number">10005</span>];<br><span class="hljs-type">int</span> top[<span class="hljs-number">100005</span>];<br><span class="hljs-type">int</span> bottom[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> x_pos[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> y_pos[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> z_pos[<span class="hljs-number">100005</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>&#123;<br>    <span class="hljs-comment">//...</span><br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> n, h, r, r_sqrt_4, top_count = <span class="hljs-number">0</span>, bottom_count = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">bool</span> flag =  <span class="hljs-literal">false</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> x, y, z;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld&quot;</span>,&amp;n,&amp;h,&amp;r);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)u[i] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;            <br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld&quot;</span>,&amp;x,&amp;y,&amp;z);x_pos[i] = x;y_pos[i] = y;z_pos[i] = z;<br>            <span class="hljs-keyword">if</span>(z+r &gt;= h)top[top_count++] = i;<br>            <span class="hljs-keyword">if</span>(z-r &lt;= <span class="hljs-number">0</span>)bottom[bottom_count++] = i;<br><br></code></pre></td></tr></table></figure>

<h3 id="（2）建立关系：集合合并-1"><a href="#（2）建立关系：集合合并-1" class="headerlink" title="（2）建立关系：集合合并"></a>（2）建立关系：集合合并</h3><p>每读取一个洞，我们便计算其与已有的洞之间的距离，若是连通，则进行合并：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> distance_sqrt(x1,x2,y1,y2,z1,z2) (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)</span><br><br><span class="hljs-comment">//...</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>&#123;<br>    <span class="hljs-comment">//...</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;i;j++)<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">distance_sqrt</span>(x_pos[j],x,y_pos[j],y,z_pos[j],z) &lt;= r*r*<span class="hljs-number">4</span>)<br>                    <span class="hljs-built_in">union_set</span>(<span class="hljs-built_in">find_u</span>(i),<span class="hljs-built_in">find_u</span>(j));<br>        &#125;<br></code></pre></td></tr></table></figure>

<h3 id="（3）搜索函数与合并函数"><a href="#（3）搜索函数与合并函数" class="headerlink" title="（3）搜索函数与合并函数"></a>（3）搜索函数与合并函数</h3><p>和前面一样，一边递归一边寻找根节点以同步实现路径压缩，不过似乎也可以递归变递推：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_u</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> n == u[n] ? n : (u[n] = <span class="hljs-built_in">find_u</span>(u[n]));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_set</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    u[<span class="hljs-built_in">find_u</span>(a)] = <span class="hljs-built_in">find_u</span>(b);<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="（4）对比元素所属集合是否相同-1"><a href="#（4）对比元素所属集合是否相同-1" class="headerlink" title="（4）对比元素所属集合是否相同"></a>（4）对比元素所属集合是否相同</h3><p>这里就是对比顶部洞所属集合与底部洞所属集合了，找到这样的连通洞后直接跳出循环就行：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;top_count;i++)&#123;<br>    <span class="hljs-keyword">if</span>(flag)<span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;bottom_count;j++)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find_u</span>(u[top[i]]) == <span class="hljs-built_in">find_u</span>(u[bottom[j]]))&#123;<br>            flag = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(flag) cout &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; endl;<br><span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; endl;<br></code></pre></td></tr></table></figure>

<h3 id="（5）完整代码实现-1"><a href="#（5）完整代码实现-1" class="headerlink" title="（5）完整代码实现"></a>（5）完整代码实现</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> distance_sqrt(x1,x2,y1,y2,z1,z2) (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) + (z1-z2)*(z1-z2)</span><br><br><span class="hljs-type">int</span> u[<span class="hljs-number">10005</span>];<br><span class="hljs-type">int</span> top[<span class="hljs-number">100005</span>];<br><span class="hljs-type">int</span> bottom[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> x_pos[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> y_pos[<span class="hljs-number">100005</span>];<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> z_pos[<span class="hljs-number">100005</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_u</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> n == u[n] ? n : (u[n] = <span class="hljs-built_in">find_u</span>(u[n]));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_set</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    u[<span class="hljs-built_in">find_u</span>(a)] = <span class="hljs-built_in">find_u</span>(b);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>&#123;<br>    <span class="hljs-type">int</span> t;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;t);<br>    <span class="hljs-keyword">while</span>(t--)&#123;<br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> n, h, r, r_sqrt_4, top_count = <span class="hljs-number">0</span>, bottom_count = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">bool</span> flag =  <span class="hljs-literal">false</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> x, y, z;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld&quot;</span>,&amp;n,&amp;h,&amp;r);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)u[i] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;            <br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld&quot;</span>,&amp;x,&amp;y,&amp;z);x_pos[i] = x;y_pos[i] = y;z_pos[i] = z;<br>            <span class="hljs-keyword">if</span>(z+r &gt;= h)top[top_count++] = i;<br>            <span class="hljs-keyword">if</span>(z-r &lt;= <span class="hljs-number">0</span>)bottom[bottom_count++] = i;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">1</span>;j&lt;i;j++)<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">distance_sqrt</span>(x_pos[j],x,y_pos[j],y,z_pos[j],z) &lt;= r*r*<span class="hljs-number">4</span>)<br>                    <span class="hljs-built_in">union_set</span>(<span class="hljs-built_in">find_u</span>(i),<span class="hljs-built_in">find_u</span>(j));<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;top_count;i++)&#123;<br>            <span class="hljs-keyword">if</span>(flag)<span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;bottom_count;j++)<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find_u</span>(u[top[i]]) == <span class="hljs-built_in">find_u</span>(u[bottom[j]]))&#123;<br>                    flag = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(flag) cout &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; endl;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;No&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="0x03-进阶：带权并查集"><a href="#0x03-进阶：带权并查集" class="headerlink" title="0x03. 进阶：带权并查集"></a>0x03. 进阶：带权并查集</h1><p>前面的亲戚关系是简单无向图，而且不带任何复杂数据记录，下面我们来看一道带权并查集的题目</p>
<h2 id="例题：NOIP-2015-提高组-Day1-T2-信息传递（普及-提高-）"><a href="#例题：NOIP-2015-提高组-Day1-T2-信息传递（普及-提高-）" class="headerlink" title="例题：NOIP 2015 提高组 Day1 T2 - 信息传递（普及&#x2F;提高-）"></a>例题：NOIP 2015 提高组 Day1 T2 - 信息传递（普及&#x2F;提高-）</h2><blockquote>
<h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="https://s2.loli.net/2025/03/08/2fFo1xmSuKrve73.png" srcset="/img/loading.gif" lazyload></p>
<p>来源：【洛谷P2661 [NOIP 2015 提高组] 信息传递】<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2661">https://www.luogu.com.cn/problem/P2661</a></p>
</blockquote>
<h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><p>玩家将自己的生日信息告知别人，并从别人那获取生日信息，首先自然还是图的连接，当存在信息传递时，我们便将节点进行连接，例如 1 号玩家向 2 号传递信息，我们便将 1 号与 2 号进行连接，形成一个图</p>
<p>但不同的是，我们这一次要求的并不仅是节点间是否存在关联关系，题目要求我们输出游戏一共可以进行多少轮</p>
<p>游戏什么时候停止呢？当有一个玩家接收到自己的信息时，也就是当图在连接过程中形成一个环时，这有点像我们的并查集的集合合并—— <strong>我们可以使用并查集判断环，若是两个节点来自同一个集合，说明形成了一个环</strong></p>
<p>环的最小长度如何判定呢？答案是 <strong>给并查集带上权值</strong> ，在合并查找的过程当中 <strong>同步计算该节点到根节点的距离</strong> ，这意味着在路径压缩的过程中我们并不像之前那样丢掉所有的路径信息，而是保留路径长度信息，我们可以使用一个额外的数组来存储， <strong>题目要求的游戏轮数便是最短边的长度</strong> </p>
<h3 id="（1）初始化元素集合-2"><a href="#（1）初始化元素集合-2" class="headerlink" title="（1）初始化元素集合"></a>（1）初始化元素集合</h3><p>主要是两个数组，一个是基本的并查集，另一个是节点到根节点的距离（全都设为 0）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> u[<span class="hljs-number">200005</span>],d[<span class="hljs-number">200005</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">int</span> min_len;<br><br><span class="hljs-comment">//...</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n;<br>    min_len = <span class="hljs-number">0xfffffff</span>;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=n;i++)u[i] = i;<br></code></pre></td></tr></table></figure>

<h3 id="（2）建立关系：集合合并-2"><a href="#（2）建立关系：集合合并-2" class="headerlink" title="（2）建立关系：集合合并"></a>（2）建立关系：集合合并</h3><p>反直觉的是每次读入输入其实就是需要我们进行集合合并的时刻：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>,x;i&lt;=n;i++)<br>    &#123;<br>        cin &gt;&gt; x;<br>        <span class="hljs-built_in">union_set</span>(i,x);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="（3）搜索函数：找寻根节点-记录权值"><a href="#（3）搜索函数：找寻根节点-记录权值" class="headerlink" title="（3）搜索函数：找寻根节点 + 记录权值"></a>（3）搜索函数：找寻根节点 + 记录权值</h3><p>如果节点不属于自身集合，递归查找其根节点，并一路记录路径长度：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_u</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(u[n] != n)&#123;<br>        <span class="hljs-type">int</span> last = u[n];<br>        u[n] = <span class="hljs-built_in">find_u</span>(u[n]);<br>        d[n] += d[last];<br>    &#125;<br>    <span class="hljs-keyword">return</span> u[n];<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="（4）对比元素所属集合是否相同-2"><a href="#（4）对比元素所属集合是否相同-2" class="headerlink" title="（4）对比元素所属集合是否相同"></a>（4）对比元素所属集合是否相同</h3><p>如果两个元素属于同一集合， <strong>说明此时形成了一个环</strong> ，因此我们同步计算最短距离</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_set</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">find_u</span>(a), y = <span class="hljs-built_in">find_u</span>(b);<br>    <span class="hljs-keyword">if</span>(x != y)&#123;<br>        u[x] = y;<br>        d[a] = d[b]+<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        min_len = <span class="hljs-built_in">min</span>(min_len,<span class="hljs-built_in">abs</span>(d[a]-d[b])+<span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="（5）完整代码实现-2"><a href="#（5）完整代码实现-2" class="headerlink" title="（5）完整代码实现"></a>（5）完整代码实现</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> u[<span class="hljs-number">200005</span>],d[<span class="hljs-number">200005</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">int</span> min_len;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_u</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(u[n] != n)&#123;<br>        <span class="hljs-type">int</span> last = u[n];<br>        u[n] = <span class="hljs-built_in">find_u</span>(u[n]);<br>        d[n] += d[last];<br>    &#125;<br>    <span class="hljs-keyword">return</span> u[n];<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_set</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">find_u</span>(a), y = <span class="hljs-built_in">find_u</span>(b);<br>    <span class="hljs-keyword">if</span>(x != y)&#123;<br>        u[x] = y;<br>        d[a] = d[b]+<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        min_len = <span class="hljs-built_in">min</span>(min_len,<span class="hljs-built_in">abs</span>(d[a]-d[b])+<span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> n;<br>    min_len = <span class="hljs-number">0xfffffff</span>;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=n;i++)u[i] = i;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>,x;i&lt;=n;i++)<br>    &#123;<br>        cin &gt;&gt; x;<br>        <span class="hljs-built_in">union_set</span>(i,x);<br>    &#125;<br>    cout &lt;&lt; min_len &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="0x04-进阶：带权并查集的综合应用场景"><a href="#0x04-进阶：带权并查集的综合应用场景" class="headerlink" title="0x04. 进阶：带权并查集的综合应用场景"></a>0x04. 进阶：带权并查集的综合应用场景</h1><h2 id="例题：NOI2002-银河英雄传说（普及-提高）"><a href="#例题：NOI2002-银河英雄传说（普及-提高）" class="headerlink" title="例题：NOI2002 银河英雄传说（普及+&#x2F;提高）"></a>例题：NOI2002 银河英雄传说（普及+&#x2F;提高）</h2><blockquote>
<h3 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="https://s2.loli.net/2025/03/08/PxFkD6pqro7MQIK.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<h3 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h3><ul>
<li>合并 &amp;&amp; 查询-&gt;<strong>带权</strong>并查集</li>
<li>三个数组：维护队列总长度<br>                    维护不同战舰到队首长度​<br>                    维护战舰归属队列</li>
</ul>
<h3 id="完整代码实现"><a href="#完整代码实现" class="headerlink" title="完整代码实现"></a>完整代码实现</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> u[<span class="hljs-number">30005</span>];<br><span class="hljs-type">int</span> dist[<span class="hljs-number">30005</span>];<br><span class="hljs-type">int</span> num[<span class="hljs-number">30005</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_u</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(u[n] != n)<br>    &#123;<br>        <span class="hljs-type">int</span> x = u[n];<br>        u[n] = <span class="hljs-built_in">find_u</span>(u[n]);<br>        dist[n] += dist[x];<br>        num[n] = num[u[n]];<br>    &#125;<br>    <span class="hljs-keyword">return</span> u[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_set</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">find_u</span>(i);<br>    <span class="hljs-type">int</span> y = <span class="hljs-built_in">find_u</span>(j);<br>    <span class="hljs-keyword">if</span>(x != y)<br>    &#123;<br>        u[x] = y;<br>        dist[x] = dist[y] + num[y];<br>        num[y] += num[x];<br>        num[x] = num[y];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">30005</span>;i++)<br>    &#123;<br>        u[i] = i;<br>        dist[i] = <span class="hljs-number">0</span>;<br>        num[i] = <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-type">int</span> t;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;t);<br>    <span class="hljs-keyword">while</span>(t--)<br>    &#123;<br>        <span class="hljs-type">char</span> ch;<br>        <span class="hljs-type">int</span> i,j;<br>        cin &gt;&gt; ch &gt;&gt; i &gt;&gt; j;<br>        <span class="hljs-type">int</span> x = <span class="hljs-built_in">find_u</span>(i);<br>        <span class="hljs-type">int</span> y = <span class="hljs-built_in">find_u</span>(j);<br>        <span class="hljs-keyword">if</span>(ch == <span class="hljs-string">&#x27;M&#x27;</span>)<br>        &#123;<br>            <span class="hljs-built_in">union_set</span>(i, j);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">if</span>(x != y)<br>                cout &lt;&lt; <span class="hljs-number">-1</span> &lt;&lt; endl;<br>            <span class="hljs-keyword">else</span><br>                cout &lt;&lt; <span class="hljs-built_in">abs</span>(dist[i]-dist[j]) - <span class="hljs-number">1</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="0x05-进阶：有向图上的并查集应用"><a href="#0x05-进阶：有向图上的并查集应用" class="headerlink" title="0x05. 进阶：有向图上的并查集应用"></a>0x05. 进阶：有向图上的并查集应用</h1><p>前面的大部分都是无向图，接下来我们来看一个有向图的上的并查集应用</p>
<h2 id="例题：Leetcode-685-冗余连接-II（困难）"><a href="#例题：Leetcode-685-冗余连接-II（困难）" class="headerlink" title="例题：Leetcode 685. 冗余连接 II（困难）"></a>例题：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/redundant-connection-ii/">Leetcode 685. 冗余连接 II</a>（困难）</h2><blockquote>
<h3 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h3><p>在本问题中，有根树指满足以下条件的 <strong>有向</strong> 图。该树只有一个根节点，所有其他节点都是该根节点的后继。该树除了根节点之外的每一个节点都有且只有一个父节点，而根节点没有父节点。</p>
<p>输入一个有向图，该图由一个有着 <code>n</code> 个节点（节点值不重复，从 <code>1</code> 到 <code>n</code>）的树及一条附加的有向边构成。附加的边包含在 <code>1</code> 到 <code>n</code> 中的两个不同顶点间，这条附加的边不属于树中已存在的边。</p>
<p>结果图是一个以边组成的二维数组 <code>edges</code> 。 每个元素是一对 <code>[ui, vi]</code>，用以表示 <strong>有向</strong> 图中连接顶点 <code>ui</code> 和顶点 <code>vi</code> 的边，其中 <code>ui</code> 是 <code>vi</code> 的一个父节点。</p>
<p>返回一条能删除的边，使得剩下的图是有 <code>n</code> 个节点的有根树。若有多个答案，返回最后出现在给定二维数组的答案。</p>
<p><strong>示例 1：</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/12/20/graph1.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">输入：edges = <span class="hljs-comment">[<span class="hljs-comment">[1,2]</span>,<span class="hljs-comment">[1,3]</span>,<span class="hljs-comment">[2,3]</span>]</span><br>输出：<span class="hljs-comment">[2,3]</span><br></code></pre></td></tr></table></figure>

<p><strong>示例 2：</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/12/20/graph2.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">输入：edges = <span class="hljs-comment">[<span class="hljs-comment">[1,2]</span>,<span class="hljs-comment">[2,3]</span>,<span class="hljs-comment">[3,4]</span>,<span class="hljs-comment">[4,1]</span>,<span class="hljs-comment">[1,5]</span>]</span><br>输出：<span class="hljs-comment">[4,1]</span><br></code></pre></td></tr></table></figure>

<p><strong>提示：</strong></p>
<ul>
<li><code>n == edges.length</code></li>
<li><code>3 &lt;= n &lt;= 1000</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>1 &lt;= ui, vi &lt;= n</code></li>
</ul>
</blockquote>
<h3 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h3><p>半夜三点多把前置题：<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/redundant-connection/">684. 冗余连接</a> 给做了，感觉稍微有了点头绪，<del>其实还是啥都不知道</del>…</p>
<p>晚上大概想清楚了，同样是采用并查集的思想，不过考虑到该图为有向图，同时题目给定的图<strong>必定有且仅有一条多余的边使得该图无法成为一颗树</strong></p>
<p>可能存在如下情况：</p>
<ul>
<li><strong>一个节点的入度大于等于2</strong>（<strong>存在两个及以上父结点，本题数据构造保证只可能存在两个父结点的情况</strong>）</li>
<li><strong>图中存在回路</strong></li>
<li><strong>以上两种情况同时存在</strong></li>
</ul>
<p>如下图所示（字丑见谅QwQ）：</p>
<p><img src="https://i.loli.net/2020/09/18/HTi1XVUF7SuIRM3.png" srcset="/img/loading.gif" lazyload></p>
<p>故我们很容易（并不Or2）能够得到解开这道题的算法：</p>
<ul>
<li><strong>将每一个结点初始化为一棵单独的树，其父结点初始化为自身</strong></li>
<li><strong>使用两个数组分别保存每个结点的父结点与所属的树的根结点</strong></li>
<li><strong>遍历每一条边，重新记录下每个结点的父结点与根节点</strong></li>
<li><strong>当一个结点的入度大于1时（出现第二个不是自身结点的父亲），记录该边为争议边</strong></li>
<li><strong>当一条边的始末结点同属于一棵树时，记录该条边为回路边</strong></li>
<li><strong>两种情况都不存在，则将该边的末结点的父结点标为该边的始结点，并合并两结点所在的树</strong></li>
<li><strong>当争议边不存在时，直接删除回路边</strong></li>
<li><strong>争议边若存在，若同时存在回路边，则删除争议边末尾结点及其父结点所构成边，否则删除争议边</strong></li>
</ul>
<h3 id="（1）初始化元素集合-3"><a href="#（1）初始化元素集合-3" class="headerlink" title="（1）初始化元素集合"></a>（1）初始化元素集合</h3><p>还是按惯例将每个节点单独作为一棵树：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> * ancestors;<span class="hljs-comment">//（并查集）记录每个节点的根结点</span><br><span class="hljs-type">int</span> * parent;<span class="hljs-comment">//记录每个节点的父结点</span><br><br><span class="hljs-comment">//...</span><br><br><span class="hljs-function"><span class="hljs-type">int</span>* <span class="hljs-title">findRedundantDirectedConnection</span><span class="hljs-params">(<span class="hljs-type">int</span>** edges, <span class="hljs-type">int</span> edgesSize, <span class="hljs-type">int</span>* edgesColSize, <span class="hljs-type">int</span>* returnSize)</span></span><br><span class="hljs-function"></span>&#123;    <br>    ancestors = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)*(edgesSize+<span class="hljs-number">5</span>));<br>    parent = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)*(edgesSize+<span class="hljs-number">5</span>));<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=edgesSize;i++)<br>    &#123;<br>        parent[i] = ancestors[i] = i;<span class="hljs-comment">//初始化每个结点为单独的一棵树（并查集），结点的父结点标记为自身</span><br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="（2）建立关系：集合合并-记录异常"><a href="#（2）建立关系：集合合并-记录异常" class="headerlink" title="（2）建立关系：集合合并 + 记录异常"></a>（2）建立关系：集合合并 + 记录异常</h3><p>我们遍历每一条边，从而逐渐连接起各个节点，建立起集合，在合并集合的过程中同时查找我们的两种冲突情况：</p>
<ul>
<li>边的首尾节点的根节点相同，说明可能存在回路</li>
<li>边的尾节点与其他节点相连，说明存在入度大于一的节点</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//conflict：可能存在争议的边</span><br>   <span class="hljs-comment">//circle：可能形成回路的边</span><br>   <span class="hljs-type">int</span> start, end, a_start, a_end, conflict = <span class="hljs-number">-1</span>, circle = <span class="hljs-number">-1</span>;<br><br>   <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;edgesSize;i++)<br>   &#123;<br>       start = edges[i][<span class="hljs-number">0</span>];<br>       end = edges[i][<span class="hljs-number">1</span>];<br>       a_start = <span class="hljs-built_in">find_x</span>(start);<br>       a_end = <span class="hljs-built_in">find_x</span>(end);<br>       <span class="hljs-keyword">if</span>(parent[end] != end)<span class="hljs-comment">//该条边的尾结点已经与其他结点相连（即加上这条边后入度大于1）</span><br>       &#123;<br>           conflict = i;<span class="hljs-comment">//记录该条边为争议边</span><br>       &#125;<br>       <span class="hljs-keyword">else</span><br>       &#123;<br>           parent[end] = start;<br>           <span class="hljs-keyword">if</span>(a_start == a_end)<br>           &#123;<br>               circle = i;<span class="hljs-comment">//该条边两结点的根结点相同，可能形成回路</span><br>           &#125;<br>           <span class="hljs-keyword">else</span><br>           &#123;<br>               <span class="hljs-built_in">union_ancestor</span>(start, end);<span class="hljs-comment">//将两棵树合并为一棵树（并查集）</span><br>           &#125;<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure>

<h3 id="（3）搜索函数与合并函数-1"><a href="#（3）搜索函数与合并函数-1" class="headerlink" title="（3）搜索函数与合并函数"></a>（3）搜索函数与合并函数</h3><p>这一块倒是比较常规的路径压缩：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_x</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span><span class="hljs-comment">//查找该结点所属树的根结点</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> x == ancestors[x] ? x : (ancestors[x] = <span class="hljs-built_in">find_x</span>(ancestors[x]));<span class="hljs-comment">//路径压缩</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_ancestor</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    ancestors[<span class="hljs-built_in">find_x</span>(a)] = <span class="hljs-built_in">find_x</span>(b);<span class="hljs-comment">//将两棵树合并为一棵树</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="（4）完整代码实现"><a href="#（4）完整代码实现" class="headerlink" title="（4）完整代码实现"></a>（4）完整代码实现</h3><p>构造代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Note: The returned array must be malloced, assume caller calls free().</span><br><span class="hljs-comment"> */</span><br> <span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Note: The returned array must be malloced, assume caller calls free().</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-type">int</span> * ancestors;<span class="hljs-comment">//（并查集）记录每个节点的根结点</span><br><span class="hljs-type">int</span> * parent;<span class="hljs-comment">//记录每个节点的父结点</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find_x</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span><span class="hljs-comment">//查找该结点所属树的根结点</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> x == ancestors[x] ? x : (ancestors[x] = <span class="hljs-built_in">find_x</span>(ancestors[x]));<span class="hljs-comment">//路径压缩</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_ancestor</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    ancestors[<span class="hljs-built_in">find_x</span>(a)] = <span class="hljs-built_in">find_x</span>(b);<span class="hljs-comment">//将两棵树合并为一棵树</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span>* <span class="hljs-title">findRedundantDirectedConnection</span><span class="hljs-params">(<span class="hljs-type">int</span>** edges, <span class="hljs-type">int</span> edgesSize, <span class="hljs-type">int</span>* edgesColSize, <span class="hljs-type">int</span>* returnSize)</span></span><br><span class="hljs-function"></span>&#123;    <br>    ancestors = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)*(edgesSize+<span class="hljs-number">5</span>));<br>    parent = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)*(edgesSize+<span class="hljs-number">5</span>));<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=edgesSize;i++)<br>    &#123;<br>        parent[i] = ancestors[i] = i;<span class="hljs-comment">//初始化每个结点为单独的一棵树（并查集），结点的父结点标记为自身</span><br>    &#125;<br>	<span class="hljs-comment">//conflict：可能存在争议的边</span><br>    <span class="hljs-comment">//circle：可能形成回路的边</span><br>    <span class="hljs-type">int</span> start, end, a_start, a_end, conflict = <span class="hljs-number">-1</span>, circle = <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;edgesSize;i++)<br>    &#123;<br>        start = edges[i][<span class="hljs-number">0</span>];<br>        end = edges[i][<span class="hljs-number">1</span>];<br>        a_start = <span class="hljs-built_in">find_x</span>(start);<br>        a_end = <span class="hljs-built_in">find_x</span>(end);<br>        <span class="hljs-keyword">if</span>(parent[end] != end)<span class="hljs-comment">//该条边的尾结点已经与其他结点相连（即加上这条边后入度大于1）</span><br>        &#123;<br>            conflict = i;<span class="hljs-comment">//记录该条边为争议边</span><br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            parent[end] = start;<br>            <span class="hljs-keyword">if</span>(a_start == a_end)<br>            &#123;<br>                circle = i;<span class="hljs-comment">//该条边两结点的根结点相同，可能形成回路</span><br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                <span class="hljs-built_in">union_ancestor</span>(start, end);<span class="hljs-comment">//将两棵树合并为一棵树（并查集）</span><br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-type">int</span> *ret = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)*<span class="hljs-number">2</span>);<br>    *returnSize = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">if</span>(conflict&lt;<span class="hljs-number">0</span>)<span class="hljs-comment">//不存在争议边，只存在形成回路的边</span><br>    &#123;<br>        ret[<span class="hljs-number">0</span>] = edges[circle][<span class="hljs-number">0</span>];<br>        ret[<span class="hljs-number">1</span>] = edges[circle][<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br>    <span class="hljs-keyword">else</span><span class="hljs-comment">//存在争议边</span><br>    &#123;<br>        <span class="hljs-keyword">if</span>(circle&gt;<span class="hljs-number">0</span>)<span class="hljs-comment">//同时存在回路边</span><br>        &#123;<br>            ret[<span class="hljs-number">0</span>] = parent[edges[conflict][<span class="hljs-number">1</span>]];<br>            ret[<span class="hljs-number">1</span>] = edges[conflict][<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">return</span> ret;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            ret[<span class="hljs-number">0</span>] = edges[conflict][<span class="hljs-number">0</span>];<br>            ret[<span class="hljs-number">1</span>] = edges[conflict][<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">return</span> ret;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="0xFF-更多相关题目"><a href="#0xFF-更多相关题目" class="headerlink" title="0xFF. 更多相关题目"></a>0xFF. 更多相关题目</h1><blockquote>
<p>POJ2236: <a target="_blank" rel="noopener" href="http://poj.org/problem?id=2236">http://poj.org/problem?id=2236</a></p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/ALGORITHM/" class="category-chain-item">ALGORITHM</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/C-C/">#C&C++</a>
      
        <a href="/tags/Algorithm/">#Algorithm</a>
      
        <a href="/tags/Disjoint-Set/">#Disjoint Set</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>【ALGORITHM.0x00】并查集算法浅析</div>
      <div>https://arttnba3.github.io/2019/09/20/ALGORITHM-0X00-DISJOINT_SET/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>arttnba3</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2019年9月20日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/04/21/ALGORITHM-0X01-DYNAMIC_PROGRAMMING/" title="【ALGORITHM.0x01】动态规划算法浅析">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">【ALGORITHM.0x01】动态规划算法浅析</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2000/10/12/NOTE-0XFF-PIECES_KNOWLEDGE/" title="【NOTES.0xFF】一些暂时没地方堆放的零碎知识点">
                        <span class="hidden-mobile">【NOTES.0xFF】一些暂时没地方堆放的零碎知识点</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appid":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appkey":"tuvJh3xYxPFcW2JB6K26RKP2","path":"window.location.pathname","placeholder":"说点什么呗（笑）","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"appId":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appKey":"tuvJh3xYxPFcW2JB6K26RKP2"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <!-- 网站运行时间的设置 -->
  <span id="timeDate">载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
      var now = new Date();
      function createtime() {
          var grt= new Date("04/20/2020 17:48:48");//此处修改你的建站时间或者网站上线时间
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
          document.getElementById("timeDate").innerHTML = "arttnba3的小屋已经安全存在了 "+dnum+" 天 ";
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
      }
  setInterval("createtime()",250);
  </script>
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      桂ICP备2022005068号-1
    </a>
  </span>
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
