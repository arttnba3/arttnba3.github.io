

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="arttnba3">
  <meta name="keywords" content="">
  
    <meta name="description" content="这个原神啊，能忍住一秒不玩的都是神人了">
<meta property="og:type" content="article">
<meta property="og:title" content="【OPS.0x02】如何在澳洲校园网内玩原神">
<meta property="og:url" content="http://example.com/2024/08/31/OPS-0X02-AUSTRALIA_FIREWALL_ESCAPE/index.html">
<meta property="og:site_name" content="arttnba3&#39;s blog">
<meta property="og:description" content="这个原神啊，能忍住一秒不玩的都是神人了">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/09/11/7PhaTAnFjBvLJGM.png">
<meta property="article:published_time" content="2024-08-30T15:46:31.000Z">
<meta property="article:modified_time" content="2025-11-19T11:17:03.229Z">
<meta property="article:author" content="arttnba3">
<meta property="article:tag" content="运维">
<meta property="article:tag" content="原神">
<meta property="article:tag" content="Firewall">
<meta property="article:tag" content="VPN">
<meta property="article:tag" content="NGINX">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2024/09/11/7PhaTAnFjBvLJGM.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>【OPS.0x02】如何在澳洲校园网内玩原神 - arttnba3&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="arttnba3's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>arttnba3&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/arttnba3">
                <i class="iconfont icon-github-fill"></i>
                GitHub
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                rss
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://s2.loli.net/2024/09/18/3NVGfOJLndohSEm.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="【OPS.0x02】如何在澳洲校园网内玩原神"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-08-31 01:46" pubdate>
          2024年8月31日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          16k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          131 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">【OPS.0x02】如何在澳洲校园网内玩原神</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：2025年11月19日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>这个原神啊，能忍住一秒不玩的都是神人了</p>
<span id="more"></span>

<h1 id="0x00-一切开始之前"><a href="#0x00-一切开始之前" class="headerlink" title="0x00. 一切开始之前"></a>0x00. 一切开始之前</h1><blockquote>
<p>注：本文 <strong>仅</strong> 涉及<strong>澳洲大学校园</strong>的网络相关状况！ ！！<strong>不涉及也不适用任何澳洲境外的任何相关或无关场景！！！</strong></p>
</blockquote>
<p>众所周知笔者现在在南半球🇦🇺的某所不知名大学读 PhD <del>摆烂</del> 当中，虽然说日常畅游 GitHub 一类的网站没有啥问题，但是非常奇怪的是校园网当中居然也存在网站封锁，例如 <a target="_blank" rel="noopener" href="https://www.taobao.com/">淘宝</a> 这样的中国购物网站就是上不去的：</p>
<p><img src="https://s2.loli.net/2024/09/11/TGRC8irBDyFcmaZ.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>包括原神也上不去，👴很愤怒💢</p>
</blockquote>
<p>虽然说 <em>在学校就该正经搞科研</em> ，但是笔者还是不太能忍受得了学校内各种网络封锁的存在，尤其是在笔者 <em>去年刚来那会在校园网内连 QQ 都登不上，只能用飞书聊天</em> ：</p>
<p><img src="https://s2.loli.net/2024/09/11/Nj3H5k7J4sbzQ6l.png" srcset="/img/loading.gif" lazyload></p>
<p>总而言之相当数量的网站 <del>尤其是原神</del> 都上不去，对笔者的生活造成了不小的影响：</p>
<p><img src="https://s2.loli.net/2024/09/11/W37A2zSiabJNnC1.png" srcset="/img/loading.gif" lazyload></p>
<p>因此笔者决定通过一些成熟的网络策略，在公有云上购买服务器做代理并架设一定的网络基础架构，以在学校内也能够重新登入一些笔者还在中国大陆的时候常用的一些网站 ： ） <del>比如玩原神</del></p>
<blockquote>
<p>注：笔者现在开始逐渐感觉自己的中文表达能力似乎在慢慢地有所下降了，不知道为啥：(</p>
</blockquote>
<h1 id="0x01-方案设计与准备工作"><a href="#0x01-方案设计与准备工作" class="headerlink" title="0x01. 方案设计与准备工作"></a>0x01. 方案设计与准备工作</h1><p>这一节简单讲一讲基本原理，以及笔者最终的方案设计： ）</p>
<blockquote>
<p>这一部分可能讲得不是很正确，因为笔者也不太懂，<del>有点愧对网安实验班出身…</del></p>
</blockquote>
<h2 id="Pre-网络代理"><a href="#Pre-网络代理" class="headerlink" title="Pre. 网络代理"></a>Pre. 网络代理</h2><p><strong>代理</strong> （Proxy）是一种特殊的服务，简单来说就是在进行互联网通信时客户端不直接向目标主机发送网络请求，而是先把请求发送给代理服务器，由代理服务器发送给目标主机，并接受响应数据再转发给客户端，这也叫 <strong>正向代理</strong> （Forward Proxy）</p>
<p><img src="https://s2.loli.net/2024/09/11/5HqDEysJgb7eLdn.png" srcset="/img/loading.gif" lazyload></p>
<p>相应地，有正向就有反向， <strong>反向代理</strong> （Reverse Proxy）主要是在服务端侧，其负责将客户端发来的请求转发给真正的服务端</p>
<p><img src="https://s2.loli.net/2024/09/11/57pIuhJ6PHQaY1w.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>例如 <a target="_blank" rel="noopener" href="https://nginx.org/en/">NGINX</a> 便是一个非常有名的有着反向代理功能的 Web 服务器软件</p>
<p><img src="https://s2.loli.net/2024/09/11/q5o1EeXMIdwxGNH.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p>我们不难想到的是，有了代理服务器的存在，我们便可以将网络请求发送给代理服务器，让代理服务器替代我们进行实际的网络请求，由于我们的代理服务器并不在防火墙限制的网站&#x2F;IP列表当中，由此我们便能借助代理服务器访问被防火墙所禁止访问的网络服务， <del>例如让👴在校园网玩原神</del></p>
<p><img src="https://s2.loli.net/2024/09/11/7PhaTAnFjBvLJGM.png" srcset="/img/loading.gif" lazyload alt="例如欧美国家有的学校会把 Facebook 给墙了，利用代理就能上 Facebook"></p>
<h2 id="Pre-信道加密与包检测对抗"><a href="#Pre-信道加密与包检测对抗" class="headerlink" title="Pre. 信道加密与包检测对抗"></a>Pre. 信道加密与包检测对抗</h2><p>但是有了代理服务器并不代表我们就能直接在澳洲校园网里畅玩原神了，部分防火墙会对传输的数据包进行检测，例如传统的 HTTP 和 SOCKS5 代理都是非加密的，无论是目的地还是内容都很容易便能被检测出来：</p>
<p><img src="https://s2.loli.net/2024/09/11/YkH1SPdZygBhrM5.png" srcset="/img/loading.gif" lazyload></p>
<p>如何对抗各种包检测技术？最简单的方法自然是给数据包进行加密与混淆，从而使得防火墙无法检测出这些流量的真正目的，例如使用 Shadowsocks、Trojan 等加密协议来隐藏代理流量的特征，或是与代理服务器之间组建 VPN，通过 VPN 间建立的加密信道来保护流量隐私：</p>
<p><img src="https://s2.loli.net/2024/09/11/Ph1xRkJBMf65UEs.png" srcset="/img/loading.gif" lazyload></p>
<p>但正所谓道高一尺魔高一丈，这些加密协议终究 <strong>存在一些特殊的内容或是行为特征</strong> ，例如 VMess 协议可以通过重放攻击的方式进行判定，此外 <strong>深度包检测技术</strong> （Deep Packet Inspection）会在传统的对数据包请求头进行检测的基础之上再对数据包的内容进行检测，如果发现了相应的指纹特征，便会进行阻断：</p>
<p><img src="https://s2.loli.net/2024/09/11/khVOWTJKSPdzbNo.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>许多网络设备、硬件防火墙厂商都有支持 DPI 的产品，例如 Advantech 家的 <a target="_blank" rel="noopener" href="https://www.advantech.com/en-us/resources/case-study/33a34926-ded6-4cb1-a357-21de674c2200">FWA-6520</a></p>
<p><img src="https://s2.loli.net/2024/09/11/X7TPaKLUbilQFh9.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p>但是深度包检测等技术终究不是万能的，针对 Shadowsocks 这种非主流协议进行阻断不会对正常通信造成太大影响，但是若是防火墙连最常见的加密流量类型都拦截则会直接影响正常的网络通信，例如 TLS （Transport Layer Security）协议是一种广泛采用的安全性协议，HTTPS 便是 <code>HTTP over TLS</code> ，Websocket 则允许我们在 HTTP 协议上建立全双工的通信，我们不难想到的是使用 HTTPS 进行通信，或是通过 Websocket over TLS 我们便能将代理流量伪装成普通的 Web 应用的流量，内部再使用 <a target="_blank" rel="noopener" href="https://xtls.github.io/en/config/outbounds/vless.html">VLESS</a> 、<a target="_blank" rel="noopener" href="https://github.com/trojan-gfw/trojan">Trojan</a> 等协议进行代理，从而轻松欺骗过学校的防火墙</p>
<blockquote>
<p>以前还有使用 TLS in TLS 的，不过这样据说流量就又呈现出可被检测的特征了：(</p>
<p>但是两层 TLS 其实并非不常见，例如当我们使用基于 TLS 的代理浏览 HTTPS 网站时，外层是 TLS 代理，内层是网站的 TLS，由此便又有了两层整合成一层的 <a target="_blank" rel="noopener" href="https://xtls.github.io/">XTLS</a> </p>
</blockquote>
<h2 id="Pre-VPS-购买"><a href="#Pre-VPS-购买" class="headerlink" title="Pre. VPS 购买"></a>Pre. VPS 购买</h2><!-- 笔者在 Vultr 上买了一台 Singapore 的 VPS，6 USD 每月，选择 Singapore 主要的原因是离国内比较近访问国内网站会比较方便，选 Vultr 的主要原因则是因为可以随时暂停计费，方案比较灵活的同时价格也还算实惠 -->

<!-- > 像 banwagong 这样的老牌 VPS 并不适合笔者，总不能流量包先从澳洲跑一趟美国再跑回国内再原路返回澳洲吧，那样延迟就上天了，对笔者而言最优选择还是数据包线路能尽量和国内形成一条直线： ） -->

<!-- ![](https://s2.loli.net/2024/09/11/s1GDHYUCQ7IVWEB.png) -->

<p>笔者在 <a target="_blank" rel="noopener" href="https://hostkvm.com/">HostKVM</a> 购买了 <code>月付 9.6 USD</code> （ <del>原价 12 USD 每月， 如果你也买的话可以使用优惠码 hostkvm 有 8 折的折扣</del> ）的位于香港特别行政区的 VPS，价格相对而言 <em>确实不便宜</em> ， <strong>但是优点是从国内访问的延迟低得可怕</strong> ：</p>
<p><img src="https://s2.loli.net/2025/10/18/c1VmUn28yYQlJb5.png" srcset="/img/loading.gif" lazyload></p>
<p>这里有一个 <strong>经常被人忽略的点</strong> 就是： <em>香港特别行政区物理上和中国大陆是连接的，那么理论上网络延迟自然应当很低？</em>  <del>相信笔者博客此前的绝大部分读者应该是以二进制安全或者系统开发作为主业而不是计算机网络，</del> 那么这里先介绍一个概念叫 <strong>自治系统</strong> （Autonomous System，aka <code>AS</code> ），简而言之 <strong>AS 是一个由指定组织控制的大型网络集合体，互联网由多个 AS 组成，AS 间通过需要手工配置的 BGP 协议进行路由</strong> ，而中国大陆到国际互联网的出口主要有 CN2、CMI 等骨干网，因此如果你想要你的 VPS 能够和中国大陆有着较低的连接延迟， <strong>VPS 所属的 AS 必须要与骨干网的 AS 间【人工建立】直连关系，否则网络流量便只能绕道其他 AS，</strong> 因此有的时候你用 traceroute 去观测网络路径会发现一个反常现象就是 <code>“明明物理上距离非常近，网络流量却需要绕道别的地方再绕回来”</code> ，<strong>核心原因就在于对应的 AS 间没有建立直连</strong> ，对应的有个名词 <del>小圈子黑话</del> 叫 <code>三网直连</code> ，指的就是 VPS 的 AS 与移动联通电信三大运营商的 AS 间存在直接连接关系， <code>三网优化</code> 指的就是 AS Path 较短，但很多 vps 的三网直连其实都只是做到了三网优化的程度 （需要注意的是这些个名词通常仅是出现在用来描述中国大陆以外的 VPS 的 <em>非正式场景下的非标准名词</em>  ，<del>不知道为什么没有科班人员来规范定义一下这些小圈子黑话</del>  ），以及还有一个点是路由去程与回程的线路并不严格对称，或者说很多时候就是不对称的，因此去程与回程路径通常需要分开独立分析，此外，同属同一 AS 下的不同 IP 段，其路由策略也可能完全不同，因此对于流量路径，你能信赖的通常只有 <em>traceroute结果</em></p>
<blockquote>
<p>因为这段原理不打算详细展开（ <del>毕竟笔者又不是专门做网络这块的</del> ），所以直接混在一个段落讲了：）</p>
</blockquote>
<p>对应到笔者的这台 VPS，电信走 CN2 线路，因此</p>
<!-- 对应到笔者的这台 VPS，归属 [AS932](https://bgp.tools/as/932#connectivity) ，使用 [bgp.tools](https://bgp.tools/prefix/149.104.0.0/19#connectivity) 查询可知其与中国联通的顶级线路 [AS10099](https://bgp.tools/as/10099#connectivity) 间存在连接，因此和大陆间的连接延迟非常低： -->

<!-- ![](https://s2.loli.net/2025/10/18/zbrGZiQT1IKO6yk.png) -->

<blockquote>
<p>当然，如果你只是纯粹的 VPS 爱好者，单纯想随便买点 VPS 来玩玩，笔者也有一些非常非常便宜的 VPS 可以推荐，例如 Cloudcone 的 <a target="_blank" rel="noopener" href="https://app.cloudcone.com.cn/vps/263/create?token=cc-turns-7-cs-2">10刀一年的小 VPS</a>  或是 <a target="_blank" rel="noopener" href="https://app.cloudcone.com.cn/vps/262/create?token=cc-turns-7-cs-1">12刀一年的小 VPS</a> ，或者是 RackNerd 的 <a target="_blank" rel="noopener" href="https://www.rnvps.com/go-358">11 刀一年的小 VPS</a> ，<del>当然这种便宜货通常就不要想有太好的网络直连质量了</del>：</p>
<p><img src="https://s2.loli.net/2024/09/30/ijyQ2LxfCn4STkv.png" srcset="/img/loading.gif" lazyload alt="反正笔者是买了一台以备不时之需"></p>
</blockquote>
<h2 id="Pre-域名购买"><a href="#Pre-域名购买" class="headerlink" title="Pre. 域名购买"></a>Pre. 域名购买</h2><p>这里我们直接上 Cloudflare 买一个就好了，反正不同的域名提供商之间价格差别也不算太大，而且 Cloudflare 在海外各种域名售卖商当中其实还算是比较便宜的，例如买个 <code>114514beastsenbei.uk</code> ，一年只要 <code>4.94USD</code> ，少喝几杯奶茶就省出来了（Especially when 笔者在澳洲买一杯奶茶都要至少 <code>5 AUD</code> 往上， <strong>少喝一两杯奶茶还真能买一年的域名</strong> ）</p>
<p><img src="https://s2.loli.net/2024/09/18/ztD75NwACxynpQf.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>注：这个域名现在还没人注册，心动的先辈建议赶紧雷…雷厉风行地购买（大嘘</p>
</blockquote>
<h1 id="0x02-正式搭建代理服务器"><a href="#0x02-正式搭建代理服务器" class="headerlink" title="0x02. 正式搭建代理服务器"></a>0x02. 正式搭建代理服务器</h1><h2 id="配置域名解析和-Cloudflare-代理"><a href="#配置域名解析和-Cloudflare-代理" class="headerlink" title="配置域名解析和 Cloudflare 代理"></a>配置域名解析和 Cloudflare 代理</h2><p>主要是为了防止 IP 直连被封 IP 后面会很麻烦，以及避免服务器真实 IP 被探查到：</p>
<p><img src="https://s2.loli.net/2024/09/12/XfYnZj1a3icGKu2.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="配置-SSH-Tunnel"><a href="#配置-SSH-Tunnel" class="headerlink" title="配置 SSH Tunnel"></a>配置 SSH Tunnel</h2><p>用 ssh 直接连接 IP 比较危险，万一 IP 或者端口被学校封锁了直接连不上服务器就尴尬了，因此我们推荐使用 Cloudflare 创建 SSH Tunnel</p>
<blockquote>
<p>Cloudflare，👴滴超人！</p>
</blockquote>
<p>简而言之创建步骤首先是 <code>Zero Trust -&gt; Networks -&gt; Tunnels -&gt; Add a tunnel -&gt; Select Cloudflared -&gt; 命名 -&gt; 安装 Cloudflared -&gt; 配置 Route Traffic</code> </p>
<p>对于 openSUSE 而言，Tumbleweed 可以直接安装，Leap 则需要借助 OPI 安装 experimental package：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo zypper <span class="hljs-keyword">in</span> opi</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo opi cloudflared</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>实际上， Cloudflare 官网给出的安装 Cloudflared 的方式是非常原始的直接下载软件包并安装，而且只提供了 Deb 和 Rpm，为什么不直接传到各大发行版仓库呢：(</p>
</blockquote>
<p>完成 Cloudflare 安装后使用官网给的参数启动：</p>
<p><img src="https://s2.loli.net/2024/09/12/ZDevGiAkytf6BU9.png" srcset="/img/loading.gif" lazyload></p>
<p>成功连接上后配置一下 Tunnel 类型等信息即可，注意这个域名不能与现有域名记录冲突：</p>
<blockquote>
<p><code>URL</code> 可以直接写 <code>127.0.0.1:22</code></p>
</blockquote>
<p><img src="https://s2.loli.net/2024/09/12/ANOrRq7LtK4ZUvH.png" srcset="/img/loading.gif" lazyload></p>
<p>最后在本地也安装一个 <code>cloudflared</code> （本地不用创建 tunnel），并在 <code>.ssh/config</code> 中添加如下配置：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Host 你的自定义域名<br>        HostName 你的自定义域名<br>        TCPKeepAlive yes<br>        <span class="hljs-keyword">User</span> <span class="hljs-title">arttnba3</span><br>        ServerAliveInterval <span class="hljs-number">15</span><br>        IdentityFile 你的私钥位置，例如~/.ssh/id_ed25519<br>        Port <span class="hljs-number">22</span><br>        ProxyCommand cloudflared access ssh --hostname %h<br></code></pre></td></tr></table></figure>

<p>之后便能通过域名连接了：</p>
<p><img src="https://s2.loli.net/2024/09/12/68RhKDnl2FWjoI3.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="TLS-证书配置"><a href="#TLS-证书配置" class="headerlink" title="TLS 证书配置"></a>TLS 证书配置</h2><h3 id="方法一：ZeroSSL-ACME-自动更新-TLS-证书"><a href="#方法一：ZeroSSL-ACME-自动更新-TLS-证书" class="headerlink" title="方法一：ZeroSSL + ACME 自动更新 TLS 证书"></a>方法一：ZeroSSL + ACME 自动更新 TLS 证书</h3><h4 id="安装-ACME"><a href="#安装-ACME" class="headerlink" title="安装 ACME"></a>安装 ACME</h4><p>首先安装 ACME 客户端，官方的安装脚本会安装到 <code>~/.acme.sh/</code> 目录下，注意改成自己邮箱：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl https://get.acme.sh | sh -s email=my@example.com</span><br></code></pre></td></tr></table></figure>

<p>之后重新载入一次 bash profile 就能直接在命令行使用 <code>acme.sh</code> 了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">source</span> ~/.bashrc</span><br></code></pre></td></tr></table></figure>

<p>之后可以选择开启自动更新：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --upgrade --auto-upgrade</span><br></code></pre></td></tr></table></figure>

<h4 id="进行证书签发"><a href="#进行证书签发" class="headerlink" title="进行证书签发"></a>进行证书签发</h4><p>接下来进行证书的签发， acme.sh 默认使用 ZeroSSL 进行签发，你也可以参照 Wiki 改成自己喜欢的证书签发方（比如 <code>Let&#39;s Encrypt</code> 之类的），不过签发前需要验证域名归属，这里主要有两种验证方式</p>
<h5 id="方法一：通过-Web-服务器进行验证"><a href="#方法一：通过-Web-服务器进行验证" class="headerlink" title="方法一：通过 Web 服务器进行验证"></a>方法一：通过 Web 服务器进行验证</h5><p>简而言之原理就是你需要先把域名解析到安装的服务器，且你需要启动一个 http web 服务，acme.sh 会在你指定的网站目录下创建临时文件供验证 （因此当前用户需要对对应目录有 <strong>写</strong> 权限），证书默认安装到  <code>~/.acme.sh/你的域名/</code> ，整个过程可以说非常流畅，下面是一个例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --issue \</span><br><span class="language-bash">-d 你的域名 \</span><br><span class="language-bash">--webroot 你的网站文件根目录</span><br></code></pre></td></tr></table></figure>

<p>然后你便可以使用如下命令安装证书到指定位置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --install-cert \</span><br><span class="language-bash">-d 你的域名 \</span><br><span class="language-bash">--key-file 自行指定的的key路径 \</span><br><span class="language-bash">--fullchain-file 自行指定的cert路径</span><br></code></pre></td></tr></table></figure>

<!-- > 这里注意有一个安全实践是 key 应当只能由 root 和管理员有权访问，因此在手工配置证书的时代通常会把 key 放在仅 root 能够访问的 `/etc/ssl/private` 目录下，这里我们也应当要遵循这个准则，因此一个 _还行_ 的实践是 **建立符号链接** ，例如 `sudo ln -sf 证书文件路径 /etc/ssl/private/自己想个名字` ，因为为你的家目录下的文件夹 _直接添加其他用户的可访问权限是坏的实践_ ， ~~当然如果你不能保证自己的家目录不会被别人读的话那确实也没什么好说的~~ -->

<p>之后你只需要将证书路径添加到对应的 Web Server 配置中就行，例如 nginx 的配置：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">443</span> ssl;<br><br>        <span class="hljs-attribute">server_name</span> 你的域名;<br><br>        <span class="hljs-attribute">ssl_protocols</span>   TLSv1.<span class="hljs-number">3</span>;<br>        <span class="hljs-attribute">ssl_certificate</span> 你的cert路径;<br>        <span class="hljs-attribute">ssl_certificate_key</span> 你的key路径;<br>        <span class="hljs-attribute">ssl_session_cache</span>       shared:SSL:<span class="hljs-number">10m</span>;<br>        <span class="hljs-attribute">ssl_session_timeout</span>     <span class="hljs-number">10m</span>;<br><br>        <span class="hljs-section">location</span> / &#123;<br>                <span class="hljs-attribute">root</span> 你的网站文件根目录;<br>                <span class="hljs-attribute">index</span> 你的网站首页文件;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果你使用 Nginx 或 Apache， acme.sh 可以自动化地完成验证，下面是一个 nginx 例子（apache 直接改成 <code>--apache</code> 即可）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --issue --nginx -d 你的域名 -d 这里可以是你的第二个域名因为支持同时签发多个域名</span><br></code></pre></td></tr></table></figure>

<h5 id="方法二：通过-DNS-进行验证"><a href="#方法二：通过-DNS-进行验证" class="headerlink" title="方法二：通过 DNS 进行验证"></a>方法二：通过 DNS 进行验证</h5><p>另外一种方式是通过添加一条新的 DNS 解析记录验证域名所有权，首先运行以下命令生成请求文本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --issue --dns -d 你的域名</span><br></code></pre></td></tr></table></figure>

<p>之后按照要求添加一条新的 TXT 记录，然后运行以下命令即可生成证书：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">acme.sh --renew -d 你的域名</span><br></code></pre></td></tr></table></figure>

<h3 id="方法二：直接使用-Cloudflare-的免费-TLS-证书"><a href="#方法二：直接使用-Cloudflare-的免费-TLS-证书" class="headerlink" title="方法二：直接使用 Cloudflare 的免费 TLS 证书"></a>方法二：直接使用 Cloudflare 的免费 TLS 证书</h3><p>Cloudflare 提供了免费的 TLS 证书，直接创建即可，需要注意的是免费证书似乎不适用于二级域名：</p>
<p><img src="https://s2.loli.net/2024/09/11/8bKsuFVLBHNIde1.png" srcset="/img/loading.gif" lazyload alt="有效期有tm的15年，这还要啥自行车！"></p>
<p>之后会保存下来一份 PEM 和一份 KEY 文件，我们将在后续配置 NGINX 时使用到这个东西</p>
<p>以及别忘了把 Cloudflare 中的 TLS 加密改为严格，否则很容易莫名其妙就 404 了：</p>
<p><img src="https://s2.loli.net/2024/09/12/vmE4h23kVWMw6Hr.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="NGINX-搭建"><a href="#NGINX-搭建" class="headerlink" title="NGINX 搭建"></a>NGINX 搭建</h2><blockquote>
<p> 这个网上教程就非常多了，笔者这里仅简略讲讲，你也可以不用参照笔者所写的这一节：）</p>
</blockquote>
<p>首先配置防火墙，开启正常网站所需的 80 和 443 端口，这里以 <code>firewalld</code> 为例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo firewall-cmd --zone=public --add-port=443/tcp --permanent</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo firewall-cmd --reload</span><br></code></pre></td></tr></table></figure>

<p>如果你的服务器使用的是 <code>ufw</code> ，则参照如下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo ufw allow 80/tcp</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo ufw allow 443/tcp</span><br></code></pre></td></tr></table></figure>

<p>然后安装 NGINX：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo zypper <span class="hljs-keyword">in</span> nginx</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="hljs-built_in">enable</span> --now nginx.service</span><br></code></pre></td></tr></table></figure>

<p>然后简单配置一个静态网页界面作为伪装，以防万一校方进行主动探测发现情况不对，首先创建配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">touch</span> /etc/nginx/vhosts.d/你的域名.conf <span class="hljs-comment"># 有的发行版路径是 /etc/nginx/conf.d/，需要注意</span></span><br></code></pre></td></tr></table></figure>

<p>在文件中写入如下内容，第一个 server 是正常的 https 网站配置，第二个 server 是监听 80 端口将 http 跳转到 https，剩下两个是把未通过指定域名的访问全都 444 中断连接：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">server_name</span> 你的域名;<br>        <span class="hljs-attribute">ssl_certificate</span>     你的证书路径;<br>        <span class="hljs-attribute">ssl_certificate_key</span> 你的密钥路径;<br>        <span class="hljs-section">location</span> / &#123;<br>                <span class="hljs-attribute">root</span> 你的静态网页目录;<br>                <span class="hljs-attribute">index</span> 你的网站首页文件（例如 index.html）;<br>        &#125;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">server_name</span> 你的域名;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://你的域名<span class="hljs-variable">$request_uri</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span>;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">443</span>;<br>        <span class="hljs-attribute">server_name</span> 你的IP;<br>        <span class="hljs-attribute">ssl_certificate</span>     你的 .pem 证书路径;<br>        <span class="hljs-attribute">ssl_certificate_key</span> 你的 .key 密钥路径;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">444</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span>;<br>        <span class="hljs-attribute">server_name</span> 你的IP;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">444</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>重启 NGINX：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo systemctl restart nginx.service</span><br></code></pre></td></tr></table></figure>

<p>之后就能正常看到我们的网站了，这里笔者随便放了一个测试页面：</p>
<p><img src="https://s2.loli.net/2024/09/12/bLMckeJWH6Bi2CN.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="配置-git-hexo-网页伪装（可选）"><a href="#配置-git-hexo-网页伪装（可选）" class="headerlink" title="配置 git + hexo 网页伪装（可选）"></a>配置 git + hexo 网页伪装（可选）</h2><h3 id="1️⃣-安装-hexo"><a href="#1️⃣-安装-hexo" class="headerlink" title="1️⃣ 安装 hexo"></a>1️⃣ 安装 hexo</h3><p>仅有一个空白页面的网站就像一个一碰就碎的纸老虎，如果笔者所在的澳洲某大学的网管一旦进行主动探测很容易就会发现这样一个网页并不值得有这么高的访问流量，从而直接封禁域名，因此我们还需要配置一个更加完善的静态网页作为伪装</p>
<p>比较容易想到的是可以把这个网站配置成一个类似个人博客这样的网站，并在上面放一些有意义的内容，这样即使手工探测也 <em>一时无法发现端倪</em> </p>
<blockquote>
<p>当然，这个做法说实话还是有点 <strong>自欺欺人</strong> 的，校园网如果真想封你难道还要挑时间看理由？</p>
</blockquote>
<p>首先是配置 hexo，细节笔者就不说了反正不少有自己博客的人大都应该尝试过（包括本站也是使用 hexo 部署的），简而言之只需要：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">注：你得先安装 nodejs，以 openSUSE 为例是 sudo zypper <span class="hljs-keyword">in</span> nodejs-common</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo npm install -g hexo</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">hexo init blog</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> blog</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">npm install</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">npm install hexo-deployer-git --save</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p> 如果要在本地查看部署效果，直接 <code>hexo server</code> 即可在 <code>localhost:4000</code> 查看</p>
</blockquote>
<h3 id="2️⃣-推送远程"><a href="#2️⃣-推送远程" class="headerlink" title="2️⃣ 推送远程"></a>2️⃣ 推送远程</h3><p>现在我们来看如何部署在远程服务器，这里笔者推荐使用 git 进行部署（ <del>因为看了一圈其他部署方式要么年久失修要么需要额外开端口要么要开启密码验证，不太安全</del> ），首先我们在远程服务器上安装 Git 并配置一个新的 git 用户：</p>
<blockquote>
<p>注：其实也可以直接用个人账户，不一定要新建一个 <code>git</code> 用户</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo zypper <span class="hljs-keyword">in</span> git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo groupadd git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo useradd -m -s /bin/bash -g git git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo passwd git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> ~/.ssh</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;你的公钥&quot;</span> &gt; ~/.ssh/authorized_keys</span><br></code></pre></td></tr></table></figure>

<p>创建空白 git 仓库，并添加 hook 执行权限：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">git init --bare ~/blog.git</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">touch</span> ~/blog.git/hooks/post-receive</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">chmod</span> +x ~/blog.git/hooks/post-receive</span><br></code></pre></td></tr></table></figure>

<p>然后修改 git 仓库目录下的 <code>hooks/post-receive</code> 文件写入如下内容以配置推送上来的文件存放的目录（别忘了给相应文件夹访问权限）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git --work-tree=/srv/www/hexo-blog --git-dir=/home/git/blog.git checkout -f<br></code></pre></td></tr></table></figure>

<p>然后修改 hexo blog 文件夹根目录的 <code>_config.yml</code> ，在末尾添加 git 相关配置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">deploy:<br>  type: git<br>  repo: git@你的ssh域名:~/blog.git<br></code></pre></td></tr></table></figure>

<p>然后运行如下<del>熟悉得不能再熟悉的</del>命令进行推送：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">hexo d -g</span><br></code></pre></td></tr></table></figure>

<p>最后修改 NGINX 配置里的静态网页目录：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">443</span> ssl;<br>        <span class="hljs-attribute">server_name</span> 你的域名;<br>        <span class="hljs-attribute">ssl_certificate</span>     你的 .pem 证书路径;<br>        <span class="hljs-attribute">ssl_certificate_key</span> 你的 .key 密钥路径;<br>        <span class="hljs-section">location</span> / &#123;<br>                <span class="hljs-attribute">root</span> 伪装网站路径;<br>                <span class="hljs-attribute">index</span> index.html;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>重启 NGINX：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo systemctl restart nginx.service</span><br></code></pre></td></tr></table></figure>

<p>然后就能正常看到 hexo 博客页面了：</p>
<p><img src="https://s2.loli.net/2024/09/18/VtjC975S2bqUHgs.png" srcset="/img/loading.gif" lazyload></p>
<!-- 更换主题后可能会碰到套 CDN 的地址访问发现样式表炸了的问题，可能是缓存没刷新，稍微等一等就好（几十分钟到几小时？） -->

<h2 id="配置-Xray"><a href="#配置-Xray" class="headerlink" title="配置 Xray"></a>配置 Xray</h2><p>总算到了安装真正的代理工具的时候，这里笔者选择 Xray 作为代理软件，代理协议出于安全起见选择  Vless （因为据称 Trojan 有 <em>非常明显的握手特征</em> ，这或许是 tls in tls 的弊端）</p>
<p>目前有两种主流方案：Xray 前置与 NGINX 前置，前置意味着该节点负责接收所有流量，并分流到相应的服务上，Xray 前置则意味着由 Xray 检测协议，并将非 <code>VLESS/Trojan/...</code> 协议“回落”到 NGINX，NGINX 前置则反过来</p>
<!-- Xray 回落 NGINX 据说已经有能够检测的手段，因此这里我们配置 NGINX 反代 WebSocket 流量转发到后端的代理服务器 -->

<h3 id="配置-Nginx"><a href="#配置-Nginx" class="headerlink" title="配置 Nginx"></a>配置 Nginx</h3><p>因为笔者没太弄懂（ <del>菜狗是这样的</del> ）从 NGINX 回落 Xray 的 Vless 该怎么配置（NGINX 配置 websocket 回落 Trojan 倒是简单，但是听说有能够被检测的特征），所以这里配置 Xray 前置，将非 Xray 的流量回落 NGINX，大概的架构图如下：</p>
<p><img src="https://s2.loli.net/2025/10/18/9e6IjgrtiJZmo7f.png" srcset="/img/loading.gif" lazyload></p>
<p>首先我们要修改 NGINX 的配置，其实就只是将原本监听的 443 端口换成另一个端口，并且将非来自本地代理的流量给 block，后面我们再配置 Xray 监听 443 并将常规 Web 流量转发到该端口：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">127.0.0.1</span>:自己想端口 ssl default_server;<br><br>        <span class="hljs-attribute">ssl_reject_handshake</span> <span class="hljs-literal">on</span>;<br>        <span class="hljs-attribute">ssl_protocols</span> TLSv1.<span class="hljs-number">2</span> TLSv1.<span class="hljs-number">3</span>;<br><br>        <span class="hljs-attribute">ssl_session_timeout</span> <span class="hljs-number">10m</span>;<br>        <span class="hljs-attribute">ssl_session_cache</span> shared:SSL:<span class="hljs-number">10m</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>        <span class="hljs-attribute">listen</span> <span class="hljs-number">127.0.0.1</span>:自己想端口 http2 ssl proxy_protocol;<br>        <span class="hljs-attribute">set_real_ip_from</span> <span class="hljs-number">127.0.0.1</span>;<br>        <span class="hljs-attribute">real_ip_header</span> proxy_protocol;<br><br>        <span class="hljs-attribute">server_name</span> 你的域名;<br><br>        <span class="hljs-attribute">ssl_protocols</span>   TLSv1.<span class="hljs-number">2</span> TLSv1.<span class="hljs-number">3</span>;<br>        <span class="hljs-attribute">ssl_certificate</span> 你的cert;<br>        <span class="hljs-attribute">ssl_certificate_key</span> 你的key;<br>        <span class="hljs-attribute">ssl_session_cache</span>       shared:SSL:<span class="hljs-number">10m</span>;<br>        <span class="hljs-attribute">ssl_session_timeout</span>     <span class="hljs-number">10m</span>;<br><br>        <span class="hljs-section">location</span> / &#123;<br>                <span class="hljs-attribute">root</span> 你的网站根目录;<br>                <span class="hljs-attribute">index</span> index.html;<br>        &#125;<br>&#125;<br><br><span class="hljs-attribute">map</span> <span class="hljs-variable">$http_upgrade</span> <span class="hljs-variable">$connection_upgrade</span> &#123;<br>        <span class="hljs-attribute">default</span> upgrade;<br>        &quot;&quot;      close;<br>&#125;<br><br><span class="hljs-attribute">map</span> <span class="hljs-variable">$proxy_protocol_addr</span> <span class="hljs-variable">$proxy_forwarded_elem</span> &#123;<br>        ~^[0-9.]+$        &quot;for=$proxy_protocol_addr&quot;;<br>        ~^[0-9A-Fa-f:.]+$ &quot;for=\&quot;[$proxy_protocol_addr]\&quot;&quot;;<br>        <span class="hljs-attribute">default</span>           <span class="hljs-string">&quot;for=unknown&quot;</span>;<br>&#125;<br><br><span class="hljs-attribute">map</span> <span class="hljs-variable">$http_forwarded</span> <span class="hljs-variable">$proxy_add_forwarded</span> &#123;<br>        &quot;~^(,[ \\t]*)*([!<span class="hljs-comment">#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+=([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+|\&quot;([\\t \\x21\\x23-\\x5B\\x5D-\\x7E\\x80-\\xFF]|\\\\[\\t \\x21-\\x7E\\x80-\\xFF])*\&quot;))?(;([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+=([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+|\&quot;([\\t \\x21\\x23-\\x5B\\x5D-\\x7E\\x80-\\xFF]|\\\\[\\t \\x21-\\x7E\\x80-\\xFF])*\&quot;))?)*([ \\t]*,([ \\t]*([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+=([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+|\&quot;([\\t \\x21\\x23-\\x5B\\x5D-\\x7E\\x80-\\xFF]|\\\\[\\t \\x21-\\x7E\\x80-\\xFF])*\&quot;))?(;([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+=([!#$%&amp;&#x27;*+.^_`|~0-9A-Za-z-]+|\&quot;([\\t \\x21\\x23-\\x5B\\x5D-\\x7E\\x80-\\xFF]|\\\\[\\t \\x21-\\x7E\\x80-\\xFF])*\&quot;))?)*)?)*$&quot; &quot;$http_forwarded, $proxy_forwarded_elem&quot;;</span><br>        <span class="hljs-attribute">default</span> <span class="hljs-string">&quot;<span class="hljs-variable">$proxy_forwarded_elem</span>&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后按惯例重启 NGINX：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo systemctl restart nginx.service</span><br></code></pre></td></tr></table></figure>

<h3 id="配置-Xray-1"><a href="#配置-Xray-1" class="headerlink" title="配置 Xray"></a>配置 Xray</h3><p>安全起见，笔者推荐使用 Docker 部署，这同时也消除了发行版之间的差异性可能导致的部署失败（例如说你可能喜欢在自己的服务器上使用奇奇怪怪的发行版）</p>
<p>首先编写配置文件 <code>config.json</code>  ，我们选用的具体配置是 <code>Vless + Vison + Reality</code> ，这里需要注意的是部分配置需要使用 <code>xray</code> 来生成，因此你或许需要先下载一份 <code>xray</code> 二进制文件：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;log&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;loglevel&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;warning&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;error&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/var/log/xray/error.log&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;access&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/var/log/xray/access.log&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;inbounds&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;listen&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.0.0.0&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;port&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">443</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vless&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;settings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;clients&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                        <span class="hljs-punctuation">&#123;</span><br>                                                <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;用 xray uuid 命令生成的字符串，所以你或许需要先下载一份 xray 二进制可执行文件到本地运行 `xray uuid`&quot;</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-attr">&quot;flow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;xtls-rprx-vision&quot;</span><br>                                        <span class="hljs-punctuation">&#125;</span><br>                                <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;decryption&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;none&quot;</span><br>                        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;streamSettings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;network&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tcp&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;security&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;reality&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;realitySettings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                        <span class="hljs-attr">&quot;dest&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;nginx监听的本地ssl端口&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;xver&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;serverNames&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                                <span class="hljs-string">&quot;你自己的域名&quot;</span><br>                                        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;privateKey&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;运行 `xray x25519` 命令生成的私钥&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;shortIds&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                                <span class="hljs-string">&quot;&quot;</span><br>                                        <span class="hljs-punctuation">]</span><br>                                <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;sniffing&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;enabled&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;destOverride&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                        <span class="hljs-string">&quot;http&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;tls&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;quic&quot;</span><br>                                <span class="hljs-punctuation">]</span><br>                        <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;outbounds&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;freedom&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;tag&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;direct&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;blackhole&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;tag&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;block&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>然后写 Dockerfile：</p>
<blockquote>
<p>需要注意，出于安全起见，你 <strong>不应当完全直接照搬笔者的这个模板，而应当手动更改为当前的最新版本的 Xray 的下载链接</strong></p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> debian:latest<br><br><span class="hljs-keyword">ARG</span> DEBIAN_FRONTEND=noninteractive<br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get upgrade -y</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get install -y curl wget unzip procps</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> wget -P /root/ https://github.com/XTLS/Xray-core/releases/download/v24.11.5/Xray-linux-64.zip</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> unzip /root/Xray-linux-64.zip -d /root/</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +x /root/xray</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./config.json /root/config.json</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/sh\n/root/xray run -config /root/config.json\nsleep infinity&quot;</span> &gt; /start.sh</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +x /start.sh</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">mkdir</span> -p /var/log/xray</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">ln</span> -sf ../usr/share/zoneinfo/Australia/Melbourne /etc/localtime</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;/start.sh&quot;</span>]</span><br></code></pre></td></tr></table></figure>

<p>这两个文件放同一个目录下，运行如下命令创建镜像并启动容器即可，方便起见这里直接使用整个服务器网络，你也可以选择自行配置端口转发：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker build -t a3xray .</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d --name=a3xray --network=host a3xray</span><br></code></pre></td></tr></table></figure>

<p>使用如下命令配置容器自启动（毕竟有的时候系统更新或许会需要你重启，<del>当然你也可以选择直接买 RedHat 或是 SUSE 的 kernel live patch 服务以避免这个需要</del> ）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker update --restart=always a3xray</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>此外，你也可以选择使用官方所给的安装脚本直接安装到本地：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo bash -c <span class="hljs-string">&quot;<span class="hljs-subst">$(curl -L https://github.com/XTLS/Xray-install/raw/main/install-release.sh)</span>&quot;</span> @ install</span><br></code></pre></td></tr></table></figure>

</blockquote>
<p>至此，服务端侧的配置全部完成</p>
<h1 id="0x03-连接代理服务器"><a href="#0x03-连接代理服务器" class="headerlink" title="0x03. 连接代理服务器"></a>0x03. 连接代理服务器</h1><h2 id="在-Linux-上进行连接"><a href="#在-Linux-上进行连接" class="headerlink" title="在 Linux 上进行连接"></a>在 Linux 上进行连接</h2><h3 id="方法一：使用原生-Xray-core-配置本地代理"><a href="#方法一：使用原生-Xray-core-配置本地代理" class="headerlink" title="方法一：使用原生 Xray-core 配置本地代理"></a>方法一：使用原生 Xray-core 配置本地代理</h3><p>docker 相对而言比较安全（ <del>如果真有人抽象到花血本在上游供应链里放一个 kernel 通杀 0day 来劫持👴的电脑当肉鸡那👴也认了</del> ），而且也没有对不同发行版环境的要求，因此笔者首推使用 docker 配置本地的代理，我们只需要把 http 请求转发到 Docker 容器中的 xray 代理就行</p>
<p>我们首先根据前面服务端的配置编写一份对应的 <code>config.json</code> ：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;log&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;loglevel&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;warning&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;error&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/var/log/xray/error.log&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;access&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/var/log/xray/access.log&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;inbounds&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;listen&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;port&quot;</span> <span class="hljs-punctuation">:</span> 自己想端口<span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;socks&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;listen&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;port&quot;</span> <span class="hljs-punctuation">:</span> 自己想端口<span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;outbounds&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vless&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;settings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;vnext&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                        <span class="hljs-punctuation">&#123;</span><br>                                                <span class="hljs-attr">&quot;address&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;你的域名&quot;</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-attr">&quot;port&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">443</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-attr">&quot;users&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                                                        <span class="hljs-punctuation">&#123;</span><br>                                                                <span class="hljs-attr">&quot;id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;前面服务端的id&quot;</span><span class="hljs-punctuation">,</span><br>                                                                <span class="hljs-attr">&quot;encryption&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;none&quot;</span><span class="hljs-punctuation">,</span><br>                                                                <span class="hljs-attr">&quot;flow&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;xtls-rprx-vision&quot;</span><br>                                                        <span class="hljs-punctuation">&#125;</span><br>                                                <span class="hljs-punctuation">]</span><br>                                        <span class="hljs-punctuation">&#125;</span><br>                                <span class="hljs-punctuation">]</span><br>                        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;streamSettings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;network&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tcp&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;security&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;reality&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;realitySettings&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                                        <span class="hljs-attr">&quot;serverName&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;你的域名&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;fingerprint&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chrome&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;password&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;前面服务端生成私钥时对应生成的密码&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-attr">&quot;shortId&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>                                <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-attr">&quot;tag&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;proxy&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;protocol&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;freedom&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;tag&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;direct&quot;</span><br>                <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>因为镜像其实不难写所以我们直接自己写一个 Dockerfile ，不过官方安装脚本仅适用于 systemd（ <del>虽然笔者不使用 OpenRC 但是还是震怒了</del> ），但是直接把 xray 的二进制可执行文件拉下来运行其实也行：</p>
<blockquote>
<p>需要注意，出于安全起见，你 <strong>不应当完全直接照搬笔者的这个模板，而应当手动更改为当前的最新版本的 Xray 的下载链接</strong></p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> debian:latest<br><br><span class="hljs-keyword">ARG</span> DEBIAN_FRONTEND=noninteractive<br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get upgrade -y</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get install -y curl wget unzip procps</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> wget -P /root/ https://github.com/XTLS/Xray-core/releases/download/v1.8.24/Xray-linux-64.zip</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> unzip /root/Xray-linux-64.zip -d /root/</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +x /root/xray</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./config.json /root/config.json</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/sh\n/root/xray run -config /root/config.json\nsleep infinity&quot;</span> &gt; /start.sh</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +x /start.sh</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">mkdir</span> -p /var/log/xray</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">ln</span> -sf ../usr/share/zoneinfo/Australia/Melbourne /etc/localtime</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;/start.sh&quot;</span>]</span><br></code></pre></td></tr></table></figure>

<p>接下来构建镜像，启动容器，并让容器与主机使用同样的网络：</p>
<blockquote>
<p>之所以不用端口转发是因为 docker 的端口转发在笔者本地似乎有些小问题，没有办法连接……（但是转发 ssh 又可以，有点奇怪）</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker build -t a3xray .</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run -d --name=a3xray --network=host a3xray</span><br></code></pre></td></tr></table></figure>

<p>然后找自己桌面环境对应的 Proxy 设置即可，以下是 KDE 环境下配置成功的界面：</p>
<p><img src="https://s2.loli.net/2025/10/20/ro9wue5HKyxfvcL.png" srcset="/img/loading.gif" lazyload></p>
<!-- ![](https://s2.loli.net/2024/09/19/HcYb9dBQ6vDImMO.png) -->

<h3 id="方法二：使用第三方客户端"><a href="#方法二：使用第三方客户端" class="headerlink" title="方法二：使用第三方客户端"></a>方法二：使用第三方客户端</h3><p>除了使用官方的 xray-core 以外，这里我们也可以选择使用一些第三方客户端，例如 singbox 和 V2rayN 之类的，这里笔者就不展开了：）</p>
<!-- 笔者物理机使用的是 openSUSE Tumbleweed，默认使用 systemd ，所以也可以直接使用官方提供的一键式安装脚本在本地进行安装：-->



<!-- 然后编写 `/usr/local/etc/xray/config.json` ： -->

<!-- > 这里笔者直接用 Windows 上 v2rayN 自动导出的，再稍微格式化了一下，懒得自己写了：） -->



<!-- 然后启动 xray： -->



<!-- 最后找自己桌面环境对应的 Proxy 设置即可，以下是 Gnome 环境下配置成功的界面： -->

<!-- ![这是 Gnome](https://s2.loli.net/2024/09/19/QiM9D76dvE8nIl1.png) -->

<h2 id="在-Android-上进行连接"><a href="#在-Android-上进行连接" class="headerlink" title="在 Android 上进行连接"></a>在 Android 上进行连接</h2><p>既然 <del>最初的</del> 目的是玩原神，那么首先肯定要先看看在手机上如何配置</p>
<p>对于 Android 系统，可以在 Google Play 商店下载 v2rayNG，参照前面 Linux 客户端的 config.json 手动输入 vless 相关配置即可，图上没画线也没字的就是留空的意思：</p>
<!--  ![](https://s2.loli.net/2024/09/19/5KhrJYWVHeQqPmc.jpg) -->

<p><img src="https://s2.loli.net/2025/10/20/eIUFA3nW4lEdNJ1.jpg" srcset="/img/loading.gif" lazyload></p>
<p>测试，成功迁移到笔者在 HostKVM 购买的位于中国香港特别行政区的服务器：</p>
<!-- ![](https://s2.loli.net/2024/09/19/SvTfzqpi2e5RsjK.jpg) -->

<p><img src="https://s2.loli.net/2025/10/20/oeKp6ylZLCT2IuQ.jpg" srcset="/img/loading.gif" lazyload></p>
<h2 id="在-Windows-上进行连接"><a href="#在-Windows-上进行连接" class="headerlink" title="在 Windows 上进行连接"></a>在 Windows 上进行连接</h2><p>大部分人物理机用的应该还是 Windows，但是笔者不用 Windows，所以这里笔者仅给一个 Windows 下大概能用的方案： ）</p>
<p>使用 <a target="_blank" rel="noopener" href="https://github.com/2dust/v2rayN">v2rayN</a> 按照和 Android 上的 V2rayNG 基本一样的方式配置就行，图上空的就是直接留空：</p>
<p><img src="https://s2.loli.net/2025/10/20/NBURxbwZPFdLSAG.png" srcset="/img/loading.gif" lazyload></p>
<!-- ![](https://s2.loli.net/2024/09/18/8bGpnTSxU716L9v.png) -->

<p>然后在系统设置里配置一下手动代理即可，V2rayN 默认监听 10808 端口：</p>
<p><img src="https://s2.loli.net/2025/10/20/g51dmyHUhAxZQVF.png" srcset="/img/loading.gif" lazyload></p>
<!-- ![](https://s2.loli.net/2024/09/18/jCRKBgI9yecsL8b.png) -->

<p>测试，成功迁移到笔者在 HostKVM 购买的位于中国香港特别行政区的服务器：</p>
<p><img src="https://s2.loli.net/2025/10/20/LeFoNIOWgREkUav.png" srcset="/img/loading.gif" lazyload></p>
<!-- ![](https://s2.loli.net/2024/09/18/kaslX7NpQe3BLRE.png) -->

<h2 id="在-iOS-上进行连接"><a href="#在-iOS-上进行连接" class="headerlink" title="在 iOS 上进行连接"></a>在 iOS 上进行连接</h2><p>对于 iOS 系统，笔者看了几个都是付费解决方案，不过总算找到一个免费的便是 V2Box，总而言之配置填写方式和前面的 V2rayN 和 V2rayNG 没啥区别：</p>
<p><img src="https://s2.loli.net/2025/10/20/CKHglJbI3ZpXOLt.png" srcset="/img/loading.gif" lazyload></p>
<p>测速，成功连接：</p>
<p><img src="https://s2.loli.net/2025/10/20/4V3fjYxzGb5TO6N.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="在-macOS-上进行连接（🕊🕊🕊）"><a href="#在-macOS-上进行连接（🕊🕊🕊）" class="headerlink" title="在 macOS 上进行连接（🕊🕊🕊）"></a>在 macOS 上进行连接（🕊🕊🕊）</h2><p>笔者 <strong>买不起 MacBook</strong> ，所以 <em>这一小节暂且搁置</em> …… （🕊🕊🕊）</p>
<h1 id="0xFF-What’s-more…"><a href="#0xFF-What’s-more…" class="headerlink" title="0xFF. What’s more…"></a>0xFF. What’s more…</h1><p>虽然说这个方案确乎是配置成功了，从原理上看似乎也是非常的安全，但是最终 <strong>还是没有办法在澳洲的校园网里以比较正常的体验玩原神</strong> ，主要原因是 <strong>延迟虽然是降低了一些，但是还是有点太高了</strong> …… 不过其实还是降了不少延迟的：）</p>
<p>而且至少到最后也还是收获了一些运维的小技巧不是么：）</p>
<p><img src="https://s2.loli.net/2024/09/18/3NVGfOJLndohSEm.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/OPS/" class="category-chain-item">OPS</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E8%BF%90%E7%BB%B4/">#运维</a>
      
        <a href="/tags/%E5%8E%9F%E7%A5%9E/">#原神</a>
      
        <a href="/tags/Firewall/">#Firewall</a>
      
        <a href="/tags/VPN/">#VPN</a>
      
        <a href="/tags/NGINX/">#NGINX</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>【OPS.0x02】如何在澳洲校园网内玩原神</div>
      <div>http://example.com/2024/08/31/OPS-0X02-AUSTRALIA_FIREWALL_ESCAPE/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>arttnba3</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年8月31日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/08/31/PAPER-0X08-HYPERDBG/" title="【PAPER.0x08】论文笔记：HyperDbg: Reinventing Hardware-Assisted Debugging">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">【PAPER.0x08】论文笔记：HyperDbg: Reinventing Hardware-Assisted Debugging</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/07/30/PAPER-0X07-KAFL/" title="【PAPER.0x07】论文笔记：kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels">
                        <span class="hidden-mobile">【PAPER.0x07】论文笔记：kAFL: Hardware-Assisted Feedback Fuzzing for OS Kernels</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appid":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appkey":"tuvJh3xYxPFcW2JB6K26RKP2","path":"window.location.pathname","placeholder":"说点什么呗（笑）","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"appId":"ICj6cPRQWFTNiOttBHlzxnIv-gzGzoHsz","appKey":"tuvJh3xYxPFcW2JB6K26RKP2"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <!-- 网站运行时间的设置 -->
  <span id="timeDate">载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
      var now = new Date();
      function createtime() {
          var grt= new Date("04/20/2020 17:48:48");//此处修改你的建站时间或者网站上线时间
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
          document.getElementById("timeDate").innerHTML = "arttnba3的小屋已经安全存在了 "+dnum+" 天 ";
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
      }
  setInterval("createtime()",250);
  </script>
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      桂ICP备2022005068号-1
    </a>
  </span>
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
